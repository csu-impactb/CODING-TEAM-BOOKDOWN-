[["enzyme-linked-immunosorbest-assay-elisa.html", "Chapter 6 Enzyme-linked immunosorbest assay (ELISA) 6.1 ELISA data analysis 6.2 Apply the fitting sigmoid model and endpoint titer function in our dataset 6.3 Create function of Fitted model and endpoint titer, where the output of the fitted model data will be the input of the endpoint titer", " Chapter 6 Enzyme-linked immunosorbest assay (ELISA) ELISA is a standard molecular biology assay for detecting and quantifying a variety of compounds, including peptides, proteins, and antibodies in a sample. The sample could be serum, plasma, or bronchoalveolar lavage fluid (BALF). 6.0.0.1 Importance of ELISA An antigen-specific reaction in the host results in the production of antibodies, which are proteins found in the blood. In the event of an infectious disease, it aids in the detection of antibodies in the body.ELISA is distinguishable from other antibody-assays in that it produces quantifiable findings and separates non-specific from specific interactions by serial binding to solid surfaces, which is often a polystyrene multiwell plate. In IMPAc-TB project, it is crucial to evaluate the if the vaccine is eliciting humoral immunity and generating antibodies against vaccine antigen. ELISA will be used to determine the presence of Immunoglobulin (Ig) IgG, IgA, and IgM in the serum different time points post-vaccination. 6.0.0.2 Principle of ELISA ELISA is based on the principle of antigen-antibody interaction. An antigen must be immobilized on a solid surface and then complexed with an enzyme-linked antibody in an ELISA. The conjugated enzyme’s activity is evaluated by incubating it with a substrate to yield a quantifiable result, which enables detection. There are four basic steps of ELISA: 1. Coating multiwell plate with antigen/antibody: This step depends on what we want to detect the sample. If we need to evaluate the the presence of antibody, the plate will be coated with the antigen, and vice versa. To coat the plate, a fixed concentration of antigen (protein) is added to a 96 well high-binding plate (charged plate). Plate is incubated over night with the antigen at 4 degree celsius (as proteins are temperature sensitive) so that antigens are completely bound to the well. 2. Blocking: It is possible that not each and every site of the well is coated with the targeted antigen, and there could be uncovered areas. It is important to block those empty spaces so that primary antibody (which we will add to the next step) binds to these spaces and give us false positive results. For this, microplate well surface-binding sites are blocked with an unrelated protein or other substance.Most common blocking agents are bovine serum albumin, skim milk, and casein. One of the best blocking agents is to use the serum from the organism in which your secondary (detection antibody) is raised. For example, if the secondary antibody is raised in goat, then we can use goat serum as a blocking agent. 3. Probing: Probing is the step where we add sample containing antibodies that we want to detect. This will be the primary antibody. If the antibodies against the antigen (which we have coated) are present in the sample, it will bind to the antigen with high affinity. 4. Washing: After the incubation of sample containing primary antibody, the wells are washed so that any unbound antibody is washed away. Washing solution contains phosphate buffer saline + 0.05% tween-20 (a mild detergent). 0.05% tween-20 washes away all the non-specific interactions as those are not strong, but keeps all the specific interaction as those are strong and cannot be detached with mild detergent. 5. Detection: To detect the presence of antibody-antigen complex, a secondary antibody labelled with an enzyme (usually horseradish peroxidase) is added to the wells, incubated and washed. 6. Signal Measurement: Finally to detect “if” and “how much” of the antibody is present, a chromogenic substrate (like 3,3’,5,5’-Tetramethylbenzidine) is added to the wells, which can be cleaved the the enzyme that is tagged to the secondary antibody. The color compund is formed after the addition of the substrate, which is directly proportional to the amount of antibody present in the sample. The plate is read on a plate reader, where color is converted to numbers. Figure 6.1: A caption 6.0.1 Loading libraries library(readxl) library(tidyverse) ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ── ## ✔ ggplot2 3.3.6 ✔ purrr 0.3.4 ## ✔ tibble 3.1.7 ✔ dplyr 1.0.9 ## ✔ tidyr 1.2.0 ✔ stringr 1.4.0 ## ✔ readr 2.1.2 ✔ forcats 0.5.1 ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() library(minpack.lm) library(broom) library(purrr) library(ggbeeswarm) 6.0.2 An example of ELISA data 6.0.2.1 Read in the first dataset Below is the example ELISA data that has came straight out of the plate reader. This data is arranged in a 96-well plate format and contains Optical Density (OD) values. elisa_raw_data &lt;- read_excel(&quot;DATA/elisa_s1_07-25-20.xlsx&quot;, sheet = &quot;S1&quot;, col_names = FALSE, range = &quot;B2:M9&quot;) ## New names: ## • `` -&gt; `...1` ## • `` -&gt; `...2` ## • `` -&gt; `...3` ## • `` -&gt; `...4` ## • `` -&gt; `...5` ## • `` -&gt; `...6` ## • `` -&gt; `...7` ## • `` -&gt; `...8` ## • `` -&gt; `...9` ## • `` -&gt; `...10` ## • `` -&gt; `...11` ## • `` -&gt; `...12` head(elisa_raw_data) ## # A tibble: 6 × 12 ## ...1 ...2 ...3 ...4 ...5 ...6 ...7 ...8 ...9 ...10 ...11 ...12 ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 5.199999999… 0.05 0.069 6.3E… 0.061 0.122 0.16… 0.145 0.135 6.80… 0.053 0.05 ## 2 7.900000000… 0.098 0.069 6.80… 0.115 0.202 5.89… 0.134 0.069 0.106 0.05 0.075 ## 3 8.899999999… 0.133 0.119 OVRF… 3.87 2.32 OVRF… 3.85 2.12 OVRF… 3.21 1.02 ## 4 OVRFLW 3.46 1.16 OVRF… 3.80 2.36 OVRF… 3.70 1.49 OVRF… 3.68 1.63 ## 5 3.815999999… 1.82 0.446 3.89… 3.42 1.13 OVRF… 2.33 0.608 OVRF… 3.41 1.10 ## 6 OVRFLW 3.69 1.43 OVRF… 3.66 1.27 3.839 1.74 0.444 2.49… 0.637 0.704 6.0.2.2 Tidy dataset 1 It is important to clean the data and arrange it in a format on which we can apply formulas and functions. # Convert all columns to numeric elisa_raw_data_numeric &lt;- elisa_raw_data %&gt;% mutate_if(is.character, as.numeric) ## Warning in mask$eval_all_mutate(quo): NAs introduced by coercion ## Warning in mask$eval_all_mutate(quo): NAs introduced by coercion ## Warning in mask$eval_all_mutate(quo): NAs introduced by coercion ## Warning in mask$eval_all_mutate(quo): NAs introduced by coercion # pivot longer the data elisa_raw_data_tidy &lt;- pivot_longer(data = elisa_raw_data_numeric, cols = &quot;...1&quot;:&quot;...12&quot;, names_to = &quot;well_id&quot;, values_to = &quot;od_450nm&quot;) # remove &quot;...&quot; from the first column elisa_raw_data_tidy$well_id &lt;- str_replace(elisa_raw_data_tidy$well_id, &quot;...&quot;, &quot;&quot;) # Add new column to the data_frame elisa_raw_data_tidy_new &lt;- elisa_raw_data_tidy %&gt;% mutate(name = rep(LETTERS[1:8], each = 12)) elisa_raw_data_tidy_new &lt;- elisa_raw_data_tidy_new %&gt;% mutate(well_id = paste0(name, well_id)) %&gt;% select(-name) head(elisa_raw_data_tidy_new) ## # A tibble: 6 × 2 ## well_id od_450nm ## &lt;chr&gt; &lt;dbl&gt; ## 1 A1 0.052 ## 2 A2 0.05 ## 3 A3 0.069 ## 4 A4 0.063 ## 5 A5 0.061 ## 6 A6 0.122 6.0.2.3 Read in the second data set The second dataset contains the information such as groups, mouse id, and dilutions for the respective wells of the 96 well plate for the dataset-1. elisa_label_data &lt;- read_excel(&quot;DATA/elisa_s1_07-25-20.xlsx&quot;, sheet = &quot;S1&quot;, col_names = FALSE, range = &quot;Q2:AB9&quot;) ## New names: ## • `` -&gt; `...1` ## • `` -&gt; `...2` ## • `` -&gt; `...3` ## • `` -&gt; `...4` ## • `` -&gt; `...5` ## • `` -&gt; `...6` ## • `` -&gt; `...7` ## • `` -&gt; `...8` ## • `` -&gt; `...9` ## • `` -&gt; `...10` ## • `` -&gt; `...11` ## • `` -&gt; `...12` head(elisa_label_data) ## # A tibble: 6 × 12 ## ...1 ...2 ...3 ...4 ...5 ...6 ...7 ...8 ...9 ...10 ...11 ...12 ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; ## 1 blank secon… naïv… 1A-1… 1A-1… 1A-1… 1A-2… 1A-2… 1A-2… 1A-3… 1A-3… 1A-3… ## 2 1A-4 (1/250 1A-4 … 1A-4… 1B-1… 1B-1… 1B-1… 1B-2… 1B-2… 1B-2… 1B-3… 1B-3… 1B-3… ## 3 1B-4 (1/250 1B-4 … 1B-4… 2A-1… 2A-1… 2A-1… 2A-2… 2A-2… 2A-2… 2A-3… 2A-3… 2A-3… ## 4 2B-1 (1/250 2B-1 … 2B-1… 2B-2… 2B-2… 2B-2… 2B-3… 2B-3… 2B-3… 2B-4… 2B-4… 2B-4… ## 5 3A-1 (1/250 3A-1 … 3A-1… 3A-2… 3A-2… 3A-2… 3A-3… 3A-3… 3A-3… 3A-4… 3A-4… 3A-4… ## 6 3B-1 (1/250 3B-1 … 3B-1… 3B-2… 3B-2… 3B-2… 3B-3… 3B-3… 3B-3… 3B-4… 3B-4… 3B-4… 6.0.2.4 Tidy dataset-2 # pivot longer the data elisa_label_data_tidy &lt;- pivot_longer(data = elisa_label_data, cols = &quot;...1&quot;:&quot;...12&quot;, names_to = &quot;well_id&quot;, values_to = &quot;information&quot;) # remove &quot;...&quot; from the first column elisa_label_data_tidy$well_id &lt;- str_replace(elisa_label_data_tidy$well_id, &quot;...&quot;, &quot;&quot;) # Add new column to the data_frame elisa_label_data_tidy_new &lt;- elisa_label_data_tidy %&gt;% mutate(name = rep(LETTERS[1:8], each = 12)) elisa_label_data_tidy_new &lt;- elisa_label_data_tidy_new %&gt;% mutate(well_id = paste0(name, well_id)) %&gt;% select(-name) head(elisa_label_data_tidy_new) ## # A tibble: 6 × 2 ## well_id information ## &lt;chr&gt; &lt;chr&gt; ## 1 A1 blank ## 2 A2 secondary ## 3 A3 naïve (1/250) ## 4 A4 1A-1 (1/250 ## 5 A5 1A-1 (1/1250 ## 6 A6 1A-1 (1/6250 6.0.2.5 Merge dataset-1 (with OD information) with dataset-2 (with respective data information) To create a complete full dataset with Groups, mouse-id, dilutions, and OD, we merged the dataset-1 and dataset-2 together. We also cleaned the data set so that mouse-ID and dilution columns are separate and have their own columns. #Merge the two datasets elisa_data = elisa_raw_data_tidy_new %&gt;% inner_join(elisa_label_data_tidy_new, by=&quot;well_id&quot;) head(elisa_data) ## # A tibble: 6 × 3 ## well_id od_450nm information ## &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 A1 0.052 blank ## 2 A2 0.05 secondary ## 3 A3 0.069 naïve (1/250) ## 4 A4 0.063 1A-1 (1/250 ## 5 A5 0.061 1A-1 (1/1250 ## 6 A6 0.122 1A-1 (1/6250 ### Separate the information table into sample ID and dilution columns tidy_elisa_data &lt;- separate(elisa_data, col = &quot;information&quot;, into = c(&quot;sample_id&quot;, &quot;dilution&quot;), sep = &quot;\\\\(&quot;) ## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 2 rows [1, 2]. head(tidy_elisa_data) ## # A tibble: 6 × 4 ## well_id od_450nm sample_id dilution ## &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; ## 1 A1 0.052 &quot;blank&quot; &lt;NA&gt; ## 2 A2 0.05 &quot;secondary&quot; &lt;NA&gt; ## 3 A3 0.069 &quot;naïve &quot; 1/250) ## 4 A4 0.063 &quot;1A-1 &quot; 1/250 ## 5 A5 0.061 &quot;1A-1 &quot; 1/1250 ## 6 A6 0.122 &quot;1A-1 &quot; 1/6250 tidy_elisa_data &lt;- tidy_elisa_data %&gt;% mutate(dilution = str_extract(dilution, &quot;(/)[0-9]+&quot;), dilution = str_replace(dilution, &quot;/&quot;, &quot;&quot;), dilution = as.numeric(dilution)) tidy_elisa_data &lt;- tidy_elisa_data %&gt;% select(well_id, sample_id, dilution, od_450nm) head(tidy_elisa_data) ## # A tibble: 6 × 4 ## well_id sample_id dilution od_450nm ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 A1 &quot;blank&quot; NA 0.052 ## 2 A2 &quot;secondary&quot; NA 0.05 ## 3 A3 &quot;naïve &quot; 250 0.069 ## 4 A4 &quot;1A-1 &quot; 250 0.063 ## 5 A5 &quot;1A-1 &quot; 1250 0.061 ## 6 A6 &quot;1A-1 &quot; 6250 0.122 6.1 ELISA data analysis Analysis of ELISA data is the most important part of the ELISA experiment. ELISA data can be analyzed in different ways based on how the data is acquired. There are a a few examples of the type of ELISA data : 1. With standard curve: ELISA can be used to determine the concentrations of the antigen and antibody. This type of ELISA data usually have a standard curve with different concentrations of the known analyte and the concentration in the sample is determined by extrapolating the unknown values in the curve. This type of assay is straightforward, easy to interpret and are more robust. 2. Without standard curve: Usually vaccine studies involve investigating the presence of high-affinity (and novel) antibodies against the vaccine antigens. Therefore, plotting a standard curve is not feasible as there is no previous information available for antibody concentration or type of antibody. Also, because antibody response to a vaccine will differ depending on the individual, it is not practical to generate a calibration curve from which absolute concentrations can be extrapolated. For this type of ELISA, quantification of the antibody titers is performed using serial dilutions of the test samples, and analysis can be performed using the following three methods (Hartman et al. 2018): Fitting sigmoid model Endpoint titer method 3: Absorbance summation method Let’s have a look at these methods, how we can apply these methods in our data, and R-based packages that we can utilize to perform this analysis. 6.1.1 1. Fitting sigmoid model: In this model, we will perform a 8-10 point serial dilution of our sample and plot a 4 parameter sigmoidal curve. 6.1.1.1 An example of the fitting sigmoid model is below: 6.1.1.1.1 Read in the data elisa_example_data &lt;- read_excel(&quot;DATA/example_elisa_data.xlsx&quot;) 6.1.1.1.2 Clean the data # separate 1/ elisa_example_data &lt;- separate(elisa_example_data, col = &quot;dilution&quot;, into = c(&quot;numerator&quot;, &quot;denomenator&quot;), sep = &quot;\\\\/&quot;) elisa_example_data &lt;- elisa_example_data %&gt;% mutate_if(is.character, as.numeric) elisa_example_data$dilution &lt;- elisa_example_data$numerator / elisa_example_data$denomenator elisa_example_data &lt;- elisa_example_data %&gt;% mutate(log_dilution = log(dilution, base = 3)) head(elisa_example_data) ## # A tibble: 6 × 5 ## numerator denomenator absorbance dilution log_dilution ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 30 4 0.0333 -3.10 ## 2 1 90 3.73 0.0111 -4.10 ## 3 1 270 2.34 0.00370 -5.10 ## 4 1 810 1.1 0.00123 -6.10 ## 5 1 2430 0.51 0.000412 -7.10 ## 6 1 7290 0.22 0.000137 -8.10 mod_1 &lt;- nlsLM(absorbance ~ ((a-d)/(1+(log_dilution/c)^b)) + d, data = elisa_example_data, start = list (a = 4, d= 0, c = -5, b = 1)) # a = maximum absorbance # d = minimum absobance # c = point of maximum growith (dilition where the curve is straight line) # b = slope at c mod_1 ## Nonlinear regression model ## model: absorbance ~ ((a - d)/(1 + (log_dilution/c)^b)) + d ## data: elisa_example_data ## a d c b ## 4.12406 0.04532 -5.31056 7.62972 ## residual sum-of-squares: 0.02221 ## ## Number of iterations to convergence: 9 ## Achieved convergence tolerance: 1.49e-08 summary(mod_1) ## ## Formula: absorbance ~ ((a - d)/(1 + (log_dilution/c)^b)) + d ## ## Parameters: ## Estimate Std. Error t value Pr(&gt;|t|) ## a 4.12406 0.05820 70.860 1.75e-12 *** ## d 0.04532 0.02268 1.998 0.0808 . ## c -5.31056 0.03933 -135.037 1.01e-14 *** ## b 7.62972 0.35854 21.280 2.50e-08 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.05269 on 8 degrees of freedom ## ## Number of iterations to convergence: 9 ## Achieved convergence tolerance: 1.49e-08 6.1.1.1.3 Create a fitted sigmoid model function and apply the function to the data tidy_params &lt;- mod_1 %&gt;% tidy() a &lt;- tidy_params$estimate[tidy_params$term == &quot;a&quot;] b &lt;- tidy_params$estimate[tidy_params$term == &quot;b&quot;] c &lt;- tidy_params$estimate[tidy_params$term == &quot;c&quot;] d &lt;- tidy_params$estimate[tidy_params$term == &quot;d&quot;] elisa_example_data &lt;- elisa_example_data %&gt;% mutate(fitted = predict(mod_1)) elisa_example_data &lt;- elisa_example_data %&gt;% mutate(fitted = predict(mod_1)) 6.1.1.1.4 Plot the signmoid curve with fitted sigmoid model elisa_example_data %&gt;% ggplot(aes(x = log_dilution, y = absorbance)) + geom_point() + geom_line(aes(y=fitted), color = &quot;dodgerblue&quot;) 6.1.2 2. Endpoint titer method The endpoint titer approach chooses an absorbance value just above the background noise (or the lower asymptotic level). The highest dilution with an absorbance greater than this predetermined value is the endpoint titer. This method is based on the assumption that a sample with a higher protein concentration will require a higher dilution factor to achieve an absorbance just above the level of background noise. 6.1.2.1 Create an endpoint titer function and apply it to the output of the fitted sigmoid model values. endpoint_titer &lt;- c * (((a - d) / (0.2 - d)) - 1) ^ (1 / b) summary(endpoint_titer) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## -8.113 -8.113 -8.113 -8.113 -8.113 -8.113 endpoint_titer ## [1] -8.113285 6.1.3 Absorbance summation method In this model of data analysis, we sum all the absorbance values from each sample to obtain one value. This value is termed as absorption summation (AS). Using the above data, the AS will be calculated as below: AS = 0.04 + 0.04 + 0.05 + 0.05 + 0.06 + 0.1 + 0.22 + 0.51 + 1.1 + 2.34 + 3.73 + 4.0 AS ## [1] 12.24 6.2 Apply the fitting sigmoid model and endpoint titer function in our dataset The presented data is from a mouse study. In this data, presence of IgG antibody has been evaluated against receptor binding domain (RBD) of SARS-CoV-2 virus in two different groups of mice. We need to elucidate which group has higher concentration of the antibodies. 6.2.0.1 Read in the data elisa_data &lt;- read_excel(&quot;DATA/elisa_data_serial_dilution.xlsx&quot;) 6.2.0.2 Tidy the data elisa_data &lt;- pivot_longer(data = elisa_data, cols = &quot;Mouse_1&quot;:&quot;Mouse_5&quot;, names_to = &quot;mouse_id&quot;, values_to = &quot;absorbance&quot;) elisa_data ## # A tibble: 100 × 4 ## Groups Dilution mouse_id absorbance ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 Group 1 1/50 Mouse_1 4.1 ## 2 Group 1 1/50 Mouse_2 3.9 ## 3 Group 1 1/50 Mouse_3 4.3 ## 4 Group 1 1/50 Mouse_4 4.2 ## 5 Group 1 1/50 Mouse_5 4 ## 6 Group 1 1/100 Mouse_1 3.9 ## 7 Group 1 1/100 Mouse_2 3.8 ## 8 Group 1 1/100 Mouse_3 3.6 ## 9 Group 1 1/100 Mouse_4 3.7 ## 10 Group 1 1/100 Mouse_5 3.8 ## # … with 90 more rows ## # ℹ Use `print(n = ...)` to see more rows # separate dilution column and convert it to log2 elisa_data &lt;- separate(elisa_data, col = &quot;Dilution&quot;, into = c(&quot;numerator&quot;, &quot;denomenator&quot;), sep = &quot;\\\\/&quot;) elisa_data &lt;- elisa_data %&gt;% transform(numerator = as.numeric(numerator), denomenator = as.numeric(denomenator)) elisa_data &lt;- elisa_data %&gt;% mutate(dilution = elisa_data$numerator / elisa_data$denomenator) elisa_data &lt;- elisa_data %&gt;% mutate(log_dilution = log2(dilution)) elisa_data ## Groups numerator denomenator mouse_id absorbance dilution log_dilution ## 1 Group 1 1 50 Mouse_1 4.10 2.00000e-02 -5.643856 ## 2 Group 1 1 50 Mouse_2 3.90 2.00000e-02 -5.643856 ## 3 Group 1 1 50 Mouse_3 4.30 2.00000e-02 -5.643856 ## 4 Group 1 1 50 Mouse_4 4.20 2.00000e-02 -5.643856 ## 5 Group 1 1 50 Mouse_5 4.00 2.00000e-02 -5.643856 ## 6 Group 1 1 100 Mouse_1 3.90 1.00000e-02 -6.643856 ## 7 Group 1 1 100 Mouse_2 3.80 1.00000e-02 -6.643856 ## 8 Group 1 1 100 Mouse_3 3.60 1.00000e-02 -6.643856 ## 9 Group 1 1 100 Mouse_4 3.70 1.00000e-02 -6.643856 ## 10 Group 1 1 100 Mouse_5 3.80 1.00000e-02 -6.643856 ## 11 Group 1 1 200 Mouse_1 3.42 5.00000e-03 -7.643856 ## 12 Group 1 1 200 Mouse_2 3.35 5.00000e-03 -7.643856 ## 13 Group 1 1 200 Mouse_3 3.56 5.00000e-03 -7.643856 ## 14 Group 1 1 200 Mouse_4 3.28 5.00000e-03 -7.643856 ## 15 Group 1 1 200 Mouse_5 3.29 5.00000e-03 -7.643856 ## 16 Group 1 1 400 Mouse_1 2.89 2.50000e-03 -8.643856 ## 17 Group 1 1 400 Mouse_2 2.98 2.50000e-03 -8.643856 ## 18 Group 1 1 400 Mouse_3 2.64 2.50000e-03 -8.643856 ## 19 Group 1 1 400 Mouse_4 2.78 2.50000e-03 -8.643856 ## 20 Group 1 1 400 Mouse_5 2.91 2.50000e-03 -8.643856 ## 21 Group 1 1 800 Mouse_1 2.12 1.25000e-03 -9.643856 ## 22 Group 1 1 800 Mouse_2 2.18 1.25000e-03 -9.643856 ## 23 Group 1 1 800 Mouse_3 2.17 1.25000e-03 -9.643856 ## 24 Group 1 1 800 Mouse_4 2.14 1.25000e-03 -9.643856 ## 25 Group 1 1 800 Mouse_5 2.21 1.25000e-03 -9.643856 ## 26 Group 1 1 1600 Mouse_1 1.89 6.25000e-04 -10.643856 ## 27 Group 1 1 1600 Mouse_2 1.98 6.25000e-04 -10.643856 ## 28 Group 1 1 1600 Mouse_3 1.76 6.25000e-04 -10.643856 ## 29 Group 1 1 1600 Mouse_4 1.69 6.25000e-04 -10.643856 ## 30 Group 1 1 1600 Mouse_5 1.82 6.25000e-04 -10.643856 ## 31 Group 1 1 3200 Mouse_1 0.97 3.12500e-04 -11.643856 ## 32 Group 1 1 3200 Mouse_2 0.85 3.12500e-04 -11.643856 ## 33 Group 1 1 3200 Mouse_3 0.88 3.12500e-04 -11.643856 ## 34 Group 1 1 3200 Mouse_4 0.84 3.12500e-04 -11.643856 ## 35 Group 1 1 3200 Mouse_5 0.91 3.12500e-04 -11.643856 ## 36 Group 1 1 6400 Mouse_1 0.52 1.56250e-04 -12.643856 ## 37 Group 1 1 6400 Mouse_2 0.48 1.56250e-04 -12.643856 ## 38 Group 1 1 6400 Mouse_3 0.42 1.56250e-04 -12.643856 ## 39 Group 1 1 6400 Mouse_4 0.48 1.56250e-04 -12.643856 ## 40 Group 1 1 6400 Mouse_5 0.47 1.56250e-04 -12.643856 ## 41 Group 1 1 12800 Mouse_1 0.26 7.81250e-05 -13.643856 ## 42 Group 1 1 12800 Mouse_2 0.21 7.81250e-05 -13.643856 ## 43 Group 1 1 12800 Mouse_3 0.27 7.81250e-05 -13.643856 ## 44 Group 1 1 12800 Mouse_4 0.26 7.81250e-05 -13.643856 ## 45 Group 1 1 12800 Mouse_5 0.28 7.81250e-05 -13.643856 ## 46 Group 1 1 25600 Mouse_1 0.12 3.90625e-05 -14.643856 ## 47 Group 1 1 25600 Mouse_2 0.16 3.90625e-05 -14.643856 ## 48 Group 1 1 25600 Mouse_3 0.17 3.90625e-05 -14.643856 ## 49 Group 1 1 25600 Mouse_4 0.16 3.90625e-05 -14.643856 ## 50 Group 1 1 25600 Mouse_5 0.14 3.90625e-05 -14.643856 ## 51 Group 2 1 50 Mouse_1 3.20 2.00000e-02 -5.643856 ## 52 Group 2 1 50 Mouse_2 3.40 2.00000e-02 -5.643856 ## 53 Group 2 1 50 Mouse_3 3.60 2.00000e-02 -5.643856 ## 54 Group 2 1 50 Mouse_4 3.20 2.00000e-02 -5.643856 ## 55 Group 2 1 50 Mouse_5 3.70 2.00000e-02 -5.643856 ## 56 Group 2 1 100 Mouse_1 2.90 1.00000e-02 -6.643856 ## 57 Group 2 1 100 Mouse_2 2.80 1.00000e-02 -6.643856 ## 58 Group 2 1 100 Mouse_3 2.70 1.00000e-02 -6.643856 ## 59 Group 2 1 100 Mouse_4 2.80 1.00000e-02 -6.643856 ## 60 Group 2 1 100 Mouse_5 2.80 1.00000e-02 -6.643856 ## 61 Group 2 1 200 Mouse_1 2.32 5.00000e-03 -7.643856 ## 62 Group 2 1 200 Mouse_2 2.35 5.00000e-03 -7.643856 ## 63 Group 2 1 200 Mouse_3 2.56 5.00000e-03 -7.643856 ## 64 Group 2 1 200 Mouse_4 2.28 5.00000e-03 -7.643856 ## 65 Group 2 1 200 Mouse_5 2.29 5.00000e-03 -7.643856 ## 66 Group 2 1 400 Mouse_1 1.89 2.50000e-03 -8.643856 ## 67 Group 2 1 400 Mouse_2 1.98 2.50000e-03 -8.643856 ## 68 Group 2 1 400 Mouse_3 1.64 2.50000e-03 -8.643856 ## 69 Group 2 1 400 Mouse_4 1.78 2.50000e-03 -8.643856 ## 70 Group 2 1 400 Mouse_5 1.91 2.50000e-03 -8.643856 ## 71 Group 2 1 800 Mouse_1 1.12 1.25000e-03 -9.643856 ## 72 Group 2 1 800 Mouse_2 1.18 1.25000e-03 -9.643856 ## 73 Group 2 1 800 Mouse_3 1.17 1.25000e-03 -9.643856 ## 74 Group 2 1 800 Mouse_4 1.14 1.25000e-03 -9.643856 ## 75 Group 2 1 800 Mouse_5 1.21 1.25000e-03 -9.643856 ## 76 Group 2 1 1600 Mouse_1 0.89 6.25000e-04 -10.643856 ## 77 Group 2 1 1600 Mouse_2 0.98 6.25000e-04 -10.643856 ## 78 Group 2 1 1600 Mouse_3 0.76 6.25000e-04 -10.643856 ## 79 Group 2 1 1600 Mouse_4 0.69 6.25000e-04 -10.643856 ## 80 Group 2 1 1600 Mouse_5 0.82 6.25000e-04 -10.643856 ## 81 Group 2 1 3200 Mouse_1 0.47 3.12500e-04 -11.643856 ## 82 Group 2 1 3200 Mouse_2 0.45 3.12500e-04 -11.643856 ## 83 Group 2 1 3200 Mouse_3 0.48 3.12500e-04 -11.643856 ## 84 Group 2 1 3200 Mouse_4 0.44 3.12500e-04 -11.643856 ## 85 Group 2 1 3200 Mouse_5 0.41 3.12500e-04 -11.643856 ## 86 Group 2 1 6400 Mouse_1 0.20 1.56250e-04 -12.643856 ## 87 Group 2 1 6400 Mouse_2 0.28 1.56250e-04 -12.643856 ## 88 Group 2 1 6400 Mouse_3 0.22 1.56250e-04 -12.643856 ## 89 Group 2 1 6400 Mouse_4 0.28 1.56250e-04 -12.643856 ## 90 Group 2 1 6400 Mouse_5 0.27 1.56250e-04 -12.643856 ## 91 Group 2 1 12800 Mouse_1 0.16 7.81250e-05 -13.643856 ## 92 Group 2 1 12800 Mouse_2 0.11 7.81250e-05 -13.643856 ## 93 Group 2 1 12800 Mouse_3 0.17 7.81250e-05 -13.643856 ## 94 Group 2 1 12800 Mouse_4 0.16 7.81250e-05 -13.643856 ## 95 Group 2 1 12800 Mouse_5 0.18 7.81250e-05 -13.643856 ## 96 Group 2 1 25600 Mouse_1 0.02 3.90625e-05 -14.643856 ## 97 Group 2 1 25600 Mouse_2 0.06 3.90625e-05 -14.643856 ## 98 Group 2 1 25600 Mouse_3 0.04 3.90625e-05 -14.643856 ## 99 Group 2 1 25600 Mouse_4 0.08 3.90625e-05 -14.643856 ## 100 Group 2 1 25600 Mouse_5 0.06 3.90625e-05 -14.643856 6.2.0.2.1 converting data into dataframe elisa_data_df &lt;- elisa_data %&gt;% group_by(Groups, mouse_id) %&gt;% summarize(log_dilution = log_dilution, absorbance = absorbance) ## `summarise()` has grouped output by &#39;Groups&#39;, &#39;mouse_id&#39;. You can override ## using the `.groups` argument. elisa_data_df ## # A tibble: 100 × 4 ## # Groups: Groups, mouse_id [10] ## Groups mouse_id log_dilution absorbance ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Group 1 Mouse_1 -5.64 4.1 ## 2 Group 1 Mouse_1 -6.64 3.9 ## 3 Group 1 Mouse_1 -7.64 3.42 ## 4 Group 1 Mouse_1 -8.64 2.89 ## 5 Group 1 Mouse_1 -9.64 2.12 ## 6 Group 1 Mouse_1 -10.6 1.89 ## 7 Group 1 Mouse_1 -11.6 0.97 ## 8 Group 1 Mouse_1 -12.6 0.52 ## 9 Group 1 Mouse_1 -13.6 0.26 ## 10 Group 1 Mouse_1 -14.6 0.12 ## # … with 90 more rows ## # ℹ Use `print(n = ...)` to see more rows elisa_data_nested &lt;- elisa_data %&gt;% group_by(Groups, mouse_id) %&gt;% nest() elisa_data_nested ## # A tibble: 10 × 3 ## # Groups: Groups, mouse_id [10] ## Groups mouse_id data ## &lt;chr&gt; &lt;chr&gt; &lt;list&gt; ## 1 Group 1 Mouse_1 &lt;tibble [10 × 5]&gt; ## 2 Group 1 Mouse_2 &lt;tibble [10 × 5]&gt; ## 3 Group 1 Mouse_3 &lt;tibble [10 × 5]&gt; ## 4 Group 1 Mouse_4 &lt;tibble [10 × 5]&gt; ## 5 Group 1 Mouse_5 &lt;tibble [10 × 5]&gt; ## 6 Group 2 Mouse_1 &lt;tibble [10 × 5]&gt; ## 7 Group 2 Mouse_2 &lt;tibble [10 × 5]&gt; ## 8 Group 2 Mouse_3 &lt;tibble [10 × 5]&gt; ## 9 Group 2 Mouse_4 &lt;tibble [10 × 5]&gt; ## 10 Group 2 Mouse_5 &lt;tibble [10 × 5]&gt; 6.2.0.2.2 plot the curves to evaluate the a, d, c, and b elisa_data %&gt;% ggplot(aes(x = log_dilution, y = absorbance)) + geom_point() + geom_line() + facet_wrap(Groups ~ mouse_id) Based on the curve, the values are: a = 4, d = 0 c = 2 b = 1 6.2.1 Creating a function for fitting model fitted_model_elisa &lt;- function(df_elisa, start_a, start_d, start_c, start_b) { mod_1 &lt;- nlsLM(absorbance ~ ((a-d)/(1+(log_dilution/c)^b)) + d, data = df_elisa, start = list(a = start_a, d = start_d, c = start_c, b = start_b)) return(mod_1) } 6.2.1.1 Fitting the model into the dataset fitted_model_elisa(elisa_data_nested$data[[1]], start_a = 4, start_d = 0, start_c = -8, start_b = 1) ## Nonlinear regression model ## model: absorbance ~ ((a - d)/(1 + (log_dilution/c)^b)) + d ## data: df_elisa ## a d c b ## 4.3070 -0.6009 -10.2577 5.2893 ## residual sum-of-squares: 0.1199 ## ## Number of iterations to convergence: 7 ## Achieved convergence tolerance: 1.49e-08 6.2.1.2 Apply the fitted model function to the whole dataframe elisa_fitted_data &lt;- elisa_data_nested %&gt;% mutate(fitted_data = purrr::map(data, ~ fitted_model_elisa(.x, start_a = 4, start_d = 0, start_c = -8, start_b = 1))) elisa_fitted_data ## # A tibble: 10 × 4 ## # Groups: Groups, mouse_id [10] ## Groups mouse_id data fitted_data ## &lt;chr&gt; &lt;chr&gt; &lt;list&gt; &lt;list&gt; ## 1 Group 1 Mouse_1 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 2 Group 1 Mouse_2 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 3 Group 1 Mouse_3 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 4 Group 1 Mouse_4 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 5 Group 1 Mouse_5 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 6 Group 2 Mouse_1 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 7 Group 2 Mouse_2 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 8 Group 2 Mouse_3 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 9 Group 2 Mouse_4 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 10 Group 2 Mouse_5 &lt;tibble [10 × 5]&gt; &lt;nls&gt; 6.2.1.3 Take out the summary of the data elisa_fitted_data_summary &lt;- elisa_fitted_data %&gt;% mutate(elisa_fitted_data_summary = purrr::map(fitted_data, broom::glance)) unnested &lt;- elisa_fitted_data_summary %&gt;% unnest(elisa_fitted_data_summary) %&gt;% ungroup() %&gt;% dplyr::select(Groups, mouse_id, fitted_data) unnested$fitted_data[[1]] ## Nonlinear regression model ## model: absorbance ~ ((a - d)/(1 + (log_dilution/c)^b)) + d ## data: df_elisa ## a d c b ## 4.3070 -0.6009 -10.2577 5.2893 ## residual sum-of-squares: 0.1199 ## ## Number of iterations to convergence: 7 ## Achieved convergence tolerance: 1.49e-08 6.3 Create function of Fitted model and endpoint titer, where the output of the fitted model data will be the input of the endpoint titer # Fitted model function fitted_model_elisa &lt;- function(df_elisa, start_a, start_d, start_c, start_b) { mod_1 &lt;- nlsLM(absorbance ~ ((a-d)/(1+(log_dilution/c)^b)) + d, data = df_elisa, start = list(a = start_a, d = start_d, c = start_c, b = start_b)) return(mod_1) } # Endpoint titer function endpoint_titer_elisa &lt;- function(fitted_data, back_value) { tidy_fitted &lt;- broom::tidy(fitted_data) est_a &lt;- tidy_fitted$estimate[tidy_fitted$term == &quot;a&quot;] est_b &lt;- tidy_fitted$estimate[tidy_fitted$term == &quot;b&quot;] est_c &lt;- tidy_fitted$estimate[tidy_fitted$term == &quot;c&quot;] est_d &lt;- tidy_fitted$estimate[tidy_fitted$term == &quot;d&quot;] endpoint_titer &lt;- est_c * (((est_a - est_d) / (back_value - est_d)) - 1) ^ (1 / est_b) return(endpoint_titer) } 6.3.0.1 Apply the fitted model fuction into the nested data and use the output of the fitted data as the input for endpoint titer value evaluation 6.3.0.1.1 Run fitted model on the data elisa_data_with_fit_model &lt;- elisa_data_nested %&gt;% mutate(fitted_data = purrr::map(data, ~ fitted_model_elisa(.x, start_a = 4, start_d = 0, start_c = -8, start_b = 1))) head(elisa_data_with_fit_model) ## # A tibble: 6 × 4 ## # Groups: Groups, mouse_id [6] ## Groups mouse_id data fitted_data ## &lt;chr&gt; &lt;chr&gt; &lt;list&gt; &lt;list&gt; ## 1 Group 1 Mouse_1 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 2 Group 1 Mouse_2 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 3 Group 1 Mouse_3 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 4 Group 1 Mouse_4 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 5 Group 1 Mouse_5 &lt;tibble [10 × 5]&gt; &lt;nls&gt; ## 6 Group 2 Mouse_1 &lt;tibble [10 × 5]&gt; &lt;nls&gt; 6.3.0.1.2 Taking output of the fitted model function and into endpoint titer function elisa_data_with_endpoint_titer &lt;- elisa_data_with_fit_model %&gt;% mutate(endpoint_data = purrr::map(fitted_data, ~ endpoint_titer_elisa(.x, back_value = 0.2))) 6.3.0.2 Plot the endpoint titer data for the two groups elisa_data_with_endpoint_titer$endpoint_data=as.numeric(elisa_data_with_endpoint_titer$endpoint_data) elisa_data_with_endpoint_titer %&gt;% ggplot(aes(x = Groups, y = endpoint_data, color = Groups)) + geom_beeswarm(cex = 3) 6.3.0.3 Perform statistical analysis on the data elisa_data_stats &lt;- t.test(endpoint_data ~ Groups, data = elisa_data_with_endpoint_titer) elisa_data_stats %&gt;% tidy() ## # A tibble: 1 × 10 ## estim…¹ estim…² estim…³ stati…⁴ p.value param…⁵ conf.…⁶ conf.…⁷ method alter…⁸ ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; ## 1 -0.800 -14.0 -13.2 -18.8 2.68e-6 5.63 -0.906 -0.695 Welch… two.si… ## # … with abbreviated variable names ¹​estimate, ²​estimate1, ³​estimate2, ## # ⁴​statistic, ⁵​parameter, ⁶​conf.low, ⁷​conf.high, ⁸​alternative References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
