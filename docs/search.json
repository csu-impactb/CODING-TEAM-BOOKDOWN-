[{"path":"index.html","id":"overview","chapter":"1 Overview","heading":"1 Overview","text":"","code":""},{"path":"index.html","id":"about-the-project","chapter":"1 Overview","heading":"1.1 About the project","text":"objective Immune Mechanisms Protection Mycobacterium tuberculosis (IMPAc-TB) program get thorough understanding immune responses necessary avoid initial infection Mycobacterium tuberculosis (Mtb), formation latent infection, progression active TB illness. achieve goals, National Institute Allergy Infectious Diseases awarded substantial funding established multidisciplinary research teams analyze immune responses Mtb animal models (mice, guinea pigs, non-human primates) humans, well immune responses elicited promising vaccine candidates. contract awards establish give seven years assistance IMPAc-TB Centers explain immune responses required Mtb infection protection.seven centers part study (alphabetical order):Colorado State UniversityHarvard T.H. Chan School Public HealthSeattle Children Hospital[]Colorado State University Team role member:Dr. Marcela Henao-Tamayo: Principal InvestigatorDr. Brendan Podell: Principal InvestigatorDr. Andres Obregon-Henao: Research Scientist-IIIDr. Taru S. Dutt: Research Scientist-[]","code":""},{"path":"index.html","id":"about-this-book","chapter":"1 Overview","heading":"1.2 About this book","text":"aim book provide data protocols data collection templates\nkey types data collected course project. using\nstandard templates record data, well starting defined pipelines \nprocess analyze data, aim standardize collection processing\ndata across project., built comprehensive guide wet lab data collection, sample processing, computational tool creation robust efficient data analysis dissemination.","code":""},{"path":"experimental-metadata.html","id":"experimental-metadata","chapter":"2 Experimental metadata","heading":"2 Experimental metadata","text":"Metadata experiment:speciesstart_dateend_dateexperimental_groups","code":""},{"path":"initial-mouse-characteristics.html","id":"initial-mouse-characteristics","chapter":"3 Initial mouse characteristics","heading":"3 Initial mouse characteristics","text":"start experiment mouse model, record several measurements\ncharacteristics mouse. record measurements along identifier\nmouse (example, based tags ear notches), can later\nlink initial characteristics mouse later measurements \nmouse.values initially record mouse include:group: identifier experimental group mouse\nassigned (e.g., “Control,” “Group 1”)group_detail: longer description mouse’s treatment group\n(e.g., “Vaccinated vaccine candidate 4 8 weeks”)notch_id: ear notch pattern mouse (e.g., “0” notch,\n“1R” one notch right ear)mouse_number: number corresponds mouse’s ear notch patter;\ntogether mouse’s group number, provides\nunique identifier mouse experimentcage_number: number cage mouse first assigned.\nmay change course experiment, mice might removed \ncage due fighting, etc. later changes cage \nrecorded []sex: Whether mouse male (“m”) female (“f”)age: Agestrain: strain mouse (e.g., “C57BL/6J” Black 6, “C3HeB/FeJ” \nKramnik)created spreadsheet template can used record data,\ncan download clicking . template currently includes\nexample data (colored blue help remember ’s \nexample). Use template, take look example data, delete \nreplace real data experiment.example first rows template might look ’s\nfilled :template used \ninitial time mice brought experiment. file format \nExcel file, can use saving computer opening \nrecording data Excel. Later code chapter read file \ntemplate format provide basic summaries data. Later code \nread files record data project-wide database, \nallow us integrate data collected course \nexperiment.[Rules naming file. Include experiment name / study ID?]","code":""},{"path":"mouse-weights.html","id":"mouse-weights","chapter":"4 Mouse Weights","heading":"4 Mouse Weights","text":"","code":""},{"path":"mouse-weights.html","id":"overview-1","chapter":"4 Mouse Weights","heading":"4.0.1 Overview","text":"Extreme weight loss loss muscle mass, also known cachexia, typically presents along side chronic inflammatory illnesses like Tuberculosis disease (Baazim, Antonio-Herrera, Bergthaler 2022). now recognize cachexia part systemic response inflammation, linked upregulation pro-inflammatory cytokines TNF, IL-6, IFNg humans (Baazim, Antonio-Herrera, Bergthaler 2022). Additionally, studies support role key immune cell populations CD8+ T-cells , depleted, counteract muscle fat deterioration (Baazim et al. 2019), suggest CD8+ T-cells may metabolically reprogram adipose tissue.recognition cachexia related illnesses diseases, tracked progression weight loss course study, done many TB-mouse studies (Smith et al. 2022; Segueni et al. 2016). data also useful correlating CFU count well expression cytokines biological markers (Smith et al. 2022). , mice weighed grams weekly monitor clinical status TB patients frequently display weight loss clinical symptom associated disease progression.following contains information data collected, organized, curated analysis RStudio.","code":""},{"path":"mouse-weights.html","id":"parameters","chapter":"4 Mouse Weights","heading":"4.0.2 Parameters","text":"Weights recorded excel worksheet.Column titles follows:who_collected: Record first name person read weight mouse scale.date_collected: Record date using quotation marks, month, day, year. example, “May 31, 2022.”sex: Record “m” male “f” femalenotch_id: Make sure record consistently across timepoints, mouse can tracked across dates. single notches, example, might “0” notches, “1R” one notch right ear, “1L” one notch left ear, “1R1L” one notch ear.mouse_numberweight: Record number, unit column. next column used units.unit: Provide units used take weight (e.g., “g” grams)cage_number: Provide cage number. provisional cage number used, … mouse switched original cage, …group: Provide experimental group mouse. sure use abbreviation notation across timepoint. Examples group designations might : bcg, saline, bcg+id93, saline+id93, saline+noMtbnotes: notes column contains information regarding clinical observations.good reference: https://elifesciences.org/articles/74419#s4","code":"\nlibrary(readxl)\nlibrary(tidyverse)## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4\n## ✓ tibble  3.1.6     ✓ dplyr   1.0.7\n## ✓ tidyr   1.1.4     ✓ stringr 1.4.0\n## ✓ readr   2.1.1     ✓ forcats 0.5.1## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n## x dplyr::filter() masks stats::filter()\n## x dplyr::lag()    masks stats::lag()"},{"path":"mouse-weights.html","id":"read-in-data","chapter":"4 Mouse Weights","heading":"4.0.3 Read in data","text":"Data stored one excel sheet, week one sheet named date -> return vector sheet name","code":""},{"path":"mouse-weights.html","id":"can-also-use-rio-to-read-in-the-data-more-streamlined","chapter":"4 Mouse Weights","heading":"4.0.4 Can also use rio to read in the data, more streamlined","text":"","code":""},{"path":"mouse-weights.html","id":"clean-data","chapter":"4 Mouse Weights","heading":"4.0.5 Clean data","text":"","code":"\ndataset <- data$before_vaccination %>%\n select(\"sex\", \"mouse_number\", \"weight\", \"cage_number\", \"group\")\n# combining columns mouse_number and cage_number\n\ndataset$mouse_id <- paste(dataset$mouse_number, \"-\", dataset$cage_number)"},{"path":"mouse-weights.html","id":"body-weight-over-time-graph-and-statistics","chapter":"4 Mouse Weights","heading":"4.0.6 Body weight over time graph and statistics","text":"","code":""},{"path":"mouse-weights.html","id":"weight-loss-over-time-graph-and-statistics","chapter":"4 Mouse Weights","heading":"4.0.7 Weight loss over time graph and statistics","text":"","code":""},{"path":"mouse-weights.html","id":"weight-vs-cfu","chapter":"4 Mouse Weights","heading":"4.0.8 Weight vs CFU","text":"","code":""},{"path":"mouse-weights.html","id":"weight-vs-elisa-results","chapter":"4 Mouse Weights","heading":"4.0.9 Weight vs ELISA results","text":"","code":""},{"path":"mouse-weights.html","id":"weight-vs-lesion-burden","chapter":"4 Mouse Weights","heading":"4.0.10 Weight vs lesion burden","text":"","code":""},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"colony-forming-units-to-determine-bacterial-counts","chapter":"5 Colony forming units to determine bacterial counts","heading":"5 Colony forming units to determine bacterial counts","text":"","code":""},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"data-description","chapter":"5 Colony forming units to determine bacterial counts","heading":"5.1 Data description","text":"data collected spreadsheet multiple sheets. first sheet\n(named “[x]”) used record metadata experiment, \nfollowing sheets used record CFUs counts plates used samples\norgan, one sheet per organ. example, plated data\nlung spleen, three sheets file: one\nmetadata, one plate counts lung, one \nplate counts spleen.metadata sheet used record information overall process \nplating data. Values sheet used calculating bacterial\nload original sample based CFU counts. spreadsheet includes\nfollowing columns:organ: Include one row organ plated experiment.\nname organ lowercase (e.g., “lung,” “spleen”). \nuse name also name sheet records data organ\nexample, rows metadata sheet “lung” “spleen,”\ntwo sheets file, one sheet named “lung” \none named “spleen,” ’ll use store plate counts \norgans.prop_resuspended: column, give proportion organ \nplated. example, plated half lung, “lung” row\nspread sheet, put 0.5 prop_resuspended column.total_resuspended_uL: column contains original volume tissue homogenate. example, raw lung tissue homogenized 500 uL PBS tube containing metal beads.og_aliquot_uL: 100 uL th total_resuspended slurry considered original aliquot used peform serial dilutions.dilution_factor: Amount original stock solution present total solution, dilution(s)plated_uL: Amount suspension + diluent plated section solid agar","code":""},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"read-in-data-1","chapter":"5 Colony forming units to determine bacterial counts","heading":"5.2 Read in data","text":"","code":"\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(purrr)\nlibrary(tidyr)\nlibrary(stringr)\nlibrary(tidyverse)\nlibrary(gridExtra)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\n#Replace w/ path to CFU sheet\npath <- c(\"DATA/Copy of baa_cfu_sheet.xlsx\")\n\nsheet_names <- excel_sheets(path)\nsheet_names <- sheet_names[!sheet_names %in% c(\"metadata\")]\n\nmerged_data <- list()\n\nfor(i in 1:length(sheet_names)){\n  \n  data <- read_excel(path, sheet = sheet_names[i]) %>% \n    mutate(organ = paste0(sheet_names[i]))\n  \n  data <- data %>% \n    #mutate(missing_col = NA) %>% \n    mutate_if(is.double, as.numeric) %>% \n    mutate_if(is.numeric, as.character) %>% \n    pivot_longer(starts_with(\"dil_\"), names_to = \"dilution\",\n                 values_to = \"CFUs\") %>% \n    mutate(dilution = str_extract(dilution, \"[0-9]+\"),\n           dilution = as.numeric(dilution))\n    \n  \n  merged_data[[i]] <- data\n  \n  \n}\n  \nall_data <- bind_rows(merged_data, .id = \"column_label\") %>% \n    select(-column_label)\n  \nhead(merged_data)## [[1]]\n## # A tibble: 342 × 8\n##    count_date           who_plated who_counted groups mouse organ dilution CFUs \n##    <chr>                <chr>      <chr>       <chr>  <chr> <chr>    <dbl> <chr>\n##  1 \"\\\"February 21 2022… BK         BK          group… A     lung         0 TNTC \n##  2 \"\\\"February 21 2022… BK         BK          group… A     lung         1 TNTC \n##  3 \"\\\"February 21 2022… BK         BK          group… A     lung         2 TNTC \n##  4 \"\\\"February 21 2022… BK         BK          group… A     lung         3 53   \n##  5 \"\\\"February 21 2022… BK         BK          group… A     lung         4 9    \n##  6 \"\\\"February 21 2022… BK         BK          group… A     lung         5 4    \n##  7 \"\\\"February 21 2022… BK         BK          group… A     lung         6 2    \n##  8 \"\\\"February 21 2022… BK         BK          group… A     lung         7 1    \n##  9 \"\\\"February 21 2022… BK         BK          group… A     lung         8 0    \n## 10 \"\\\"February 21 2022… BK         BK          group… B     lung         0 TNTC \n## # … with 332 more rows\n## \n## [[2]]\n## # A tibble: 112 × 8\n##    count_date          who_plated who_counted groups  mouse organ dilution CFUs \n##    <chr>               <chr>      <chr>       <chr>   <chr> <chr>    <dbl> <chr>\n##  1 \"\\\"April 25 2022\\\"\" JR         JR          group_1 A     sple…        0 TNTC \n##  2 \"\\\"April 25 2022\\\"\" JR         JR          group_1 A     sple…        1 TNTC \n##  3 \"\\\"April 25 2022\\\"\" JR         JR          group_1 A     sple…        2 53   \n##  4 \"\\\"April 25 2022\\\"\" JR         JR          group_1 A     sple…        3 9    \n##  5 \"\\\"April 25 2022\\\"\" JR         JR          group_1 A     sple…        4 4    \n##  6 \"\\\"April 25 2022\\\"\" JR         JR          group_1 A     sple…        5 2    \n##  7 \"\\\"April 25 2022\\\"\" JR         JR          group_1 A     sple…        6 1    \n##  8 \"\\\"April 25 2022\\\"\" JR         JR          group_1 A     sple…        7 0    \n##  9 \"\\\"April 25 2022\\\"\" JR         JR          group_1 B     sple…        0 TNTC \n## 10 \"\\\"April 25 2022\\\"\" JR         JR          group_1 B     sple…        1 TNTC \n## # … with 102 more rows\nhead(all_data)## # A tibble: 6 × 8\n##   count_date            who_plated who_counted groups mouse organ dilution CFUs \n##   <chr>                 <chr>      <chr>       <chr>  <chr> <chr>    <dbl> <chr>\n## 1 \"\\\"February 21 2022\\… BK         BK          group… A     lung         0 TNTC \n## 2 \"\\\"February 21 2022\\… BK         BK          group… A     lung         1 TNTC \n## 3 \"\\\"February 21 2022\\… BK         BK          group… A     lung         2 TNTC \n## 4 \"\\\"February 21 2022\\… BK         BK          group… A     lung         3 53   \n## 5 \"\\\"February 21 2022\\… BK         BK          group… A     lung         4 9    \n## 6 \"\\\"February 21 2022\\… BK         BK          group… A     lung         5 4"},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"example-one","chapter":"5 Colony forming units to determine bacterial counts","heading":"5.3 Example one","text":"","code":""},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"exploratory-analysis-and-quality-checks","chapter":"5 Colony forming units to determine bacterial counts","heading":"5.4 Exploratory analysis and quality checks","text":"","code":""},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"exploratory-analysis","chapter":"5 Colony forming units to determine bacterial counts","heading":"5.5 Exploratory analysis","text":"Dimensions input data:Based input data, data collected following organ \norgans:following number mice included :following number replicates recorded count date \nexperimental group:following number dilutions dilution level recorded \norgan:People plated collected data. Date dates counting:Based input data, plates included data counted \nfollowing person persons:\nBased input data, plates included data counted \nfollowing date dates:Distribution CFUs dilution:’s plot shows many plates numerous count \ndilution level:plot shows CFU counts distributed dilution\nlevel data:","code":"\nall_data %>%\n  select(organ, who_plated, who_counted, count_date) %>%\n  distinct()## # A tibble: 3 × 4\n##   organ  who_plated who_counted count_date            \n##   <chr>  <chr>      <chr>       <chr>                 \n## 1 lung   BK         BK          \"\\\"February 21 2022\\\"\"\n## 2 lung   BK         BK          \"\\\"April 18 2022\\\"\"   \n## 3 spleen JR         JR          \"\\\"April 25 2022\\\"\"\nhead(all_data)## # A tibble: 6 × 8\n##   count_date            who_plated who_counted groups mouse organ dilution CFUs \n##   <chr>                 <chr>      <chr>       <chr>  <chr> <chr>    <dbl> <chr>\n## 1 \"\\\"February 21 2022\\… BK         BK          group… A     lung         0 TNTC \n## 2 \"\\\"February 21 2022\\… BK         BK          group… A     lung         1 TNTC \n## 3 \"\\\"February 21 2022\\… BK         BK          group… A     lung         2 TNTC \n## 4 \"\\\"February 21 2022\\… BK         BK          group… A     lung         3 53   \n## 5 \"\\\"February 21 2022\\… BK         BK          group… A     lung         4 9    \n## 6 \"\\\"February 21 2022\\… BK         BK          group… A     lung         5 4"},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"identify-a-good-dilution-for-each-sample","chapter":"5 Colony forming units to determine bacterial counts","heading":"5.6 Identify a good dilution for each sample","text":"","code":"\n# Make all_data into tidy data and filter for CFUs between 10-75\n  \ntidy_cfu_data <- all_data %>%\n  mutate(dilution = str_extract(dilution, \"[0-9]+\"),\n         dilution = as.numeric(dilution)) %>%\n  filter((CFUs >= 5 & CFUs <= 95) | groups == \"control\") %>%\n  mutate(CFUs = as.numeric(CFUs)) \n\n\nhead(tidy_cfu_data)## # A tibble: 6 × 8\n##   count_date            who_plated who_counted groups mouse organ dilution  CFUs\n##   <chr>                 <chr>      <chr>       <chr>  <chr> <chr>    <dbl> <dbl>\n## 1 \"\\\"February 21 2022\\… BK         BK          group… A     lung         3    53\n## 2 \"\\\"February 21 2022\\… BK         BK          group… A     lung         4     9\n## 3 \"\\\"February 21 2022\\… BK         BK          group… C     lung         5     8\n## 4 \"\\\"February 21 2022\\… BK         BK          group… D     lung         3    53\n## 5 \"\\\"February 21 2022\\… BK         BK          group… A     lung         2    92\n## 6 \"\\\"February 21 2022\\… BK         BK          group… A     lung         4     7"},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"calculate-cfus-from-best-dilutionestimate-bacterial-load-for-each-sample-based-on-good-dilution","chapter":"5 Colony forming units to determine bacterial counts","heading":"5.7 Calculate CFUs from best dilution/Estimate bacterial load for each sample based on good dilution","text":"","code":"\n# Calculating CFU/ml for every qualifying replicate between 10-75 CFUs. Column binding by organ name to the metadata sheet via inner_join().\nmeta <- read_excel(path, sheet = \"metadata\")\n\ntidy_cfu_meta_joined <- inner_join(meta, tidy_cfu_data) %>%\n  group_by(groups) %>% \n  mutate(CFUs_per_ml = (CFUs * (dilution_factor^dilution) * \n                          (total_resuspension_mL/volume_plated_ul) * 1000)) %>%\n  select(organ, count_date, who_plated, who_counted, groups,  mouse, dilution,  \n         CFUs, CFUs_per_ml) %>% \n  ungroup()## Joining, by = \"organ\"\nhead(tidy_cfu_meta_joined)## # A tibble: 6 × 9\n##   organ count_date            who_plated who_counted groups mouse dilution  CFUs\n##   <chr> <chr>                 <chr>      <chr>       <chr>  <chr>    <dbl> <dbl>\n## 1 lung  \"\\\"February 21 2022\\… BK         BK          group… A            3    53\n## 2 lung  \"\\\"February 21 2022\\… BK         BK          group… A            4     9\n## 3 lung  \"\\\"February 21 2022\\… BK         BK          group… C            5     8\n## 4 lung  \"\\\"February 21 2022\\… BK         BK          group… D            3    53\n## 5 lung  \"\\\"February 21 2022\\… BK         BK          group… A            2    92\n## 6 lung  \"\\\"February 21 2022\\… BK         BK          group… A            4     7\n## # … with 1 more variable: CFUs_per_ml <dbl>"},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"create-initial-report-information-for-these-data","chapter":"5 Colony forming units to determine bacterial counts","heading":"5.8 Create initial report information for these data","text":"","code":"\ntidy_lung_cfu_plot <- tidy_cfu_meta_joined %>%\n  filter(organ == \"lung\") %>%\n  mutate(group = fct_relevel(groups, \"group_1\", \"group_2\", \"group_3\", \"group_4\")) %>%\n  ggplot(aes(x = groups, y = log10(CFUs_per_ml), fill = groups))+\n  stat_boxplot( aes(x = groups, y = log10(CFUs_per_ml)), \n    geom='errorbar', linetype=1, width=0.5)+ \n  geom_boxplot(aes(group = groups), fill = NA, show.legend = FALSE, color = \"lightgrey\")+\n  geom_point(show.legend = FALSE)+\n  labs(title = paste0(\"CFUs in early infected mouse lung\"), x = \"Group\", y = \"log10(CFU/mL)\",\n       color = \"Group\")+\n  guides(shape = \"none\")+\n  theme_minimal()+\n  stat_compare_means(label = \"p.signif\", method = \"t.test\", ref.group = \"group_1\") + \n  scale_y_continuous(expand = c(0, 0), limits = c(0, 8))\n\ntidy_lung_cfu_plot"},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"sample-anova","chapter":"5 Colony forming units to determine bacterial counts","heading":"5.9 Sample ANOVA","text":"","code":"\ncfu_stats <- tidy_cfu_meta_joined %>% \n  group_by(organ) %>%\n  nest() %>%\n  mutate(aov_result = map(data, ~aov(CFUs_per_ml ~ groups, data = .x)),\n         tukey_result = map(aov_result, TukeyHSD),\n         tidy_tukey = map(tukey_result, broom::tidy)) %>%\n  unnest(tidy_tukey, .drop = TRUE) %>%\n  separate(contrast, into = c(\"contrast1\", \"contrast2\"), sep = \"-\") %>%\n  select(-data, -aov_result, -tukey_result, -term, -null.value)# %>%## Warning: The `.drop` argument of `unnest()` is deprecated as of tidyr 1.0.0.\n## All list-columns are now preserved.\n## This warning is displayed once every 8 hours.\n## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.\n  # filter(adj.p.value <= 0.05)\n\ncfu_stats## # A tibble: 9 × 7\n## # Groups:   organ [2]\n##   organ  contrast1 contrast2 estimate conf.low conf.high adj.p.value\n##   <chr>  <chr>     <chr>        <dbl>    <dbl>     <dbl>       <dbl>\n## 1 lung   group_2   group_1    -60953. -138742.    16836.      0.171 \n## 2 lung   group_3   group_1    -63903. -135699.     7893.      0.0963\n## 3 lung   group_4   group_1    -26214. -102416.    49987.      0.793 \n## 4 lung   group_3   group_2     -2950.  -69900.    64000.      0.999 \n## 5 lung   group_4   group_2     34739.  -36915.   106393.      0.569 \n## 6 lung   group_4   group_3     37689.  -27410.   102787.      0.417 \n## 7 spleen group_2   group_1     -6565   -13529.      399.      0.0656\n## 8 spleen group_3   group_1     -7310   -13341.    -1279.      0.0178\n## 9 spleen group_3   group_2      -745.   -6776.     5286.      0.943"},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"save-processed-data-to-database","chapter":"5 Colony forming units to determine bacterial counts","heading":"5.10 Save processed data to database","text":"","code":""},{"path":"colony-forming-units-to-determine-bacterial-counts.html","id":"example-two","chapter":"5 Colony forming units to determine bacterial counts","heading":"5.11 Example two","text":"","code":""},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"enzyme-linked-immunosorbest-assay-elisa","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6 Enzyme-linked immunosorbest assay (ELISA)","text":"ELISA standard molecular biology assay detecting quantifying \nvariety compounds, including peptides, proteins, antibodies sample.\nsample serum, plasma, bronchoalveolar lavage fluid (BALF).","code":""},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"importance-of-elisa","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.1 Importance of ELISA","text":"antigen-specific reaction host results production antibodies, proteins found blood. event infectious disease,\naids detection antibodies body. ELISA distinguishable antibody-assays produces quantifiable findings separates non-specific specific interactions serial binding solid surfaces,\noften polystyrene multi-well plate.IMPAc-TB project, crucial evaluate vaccine eliciting humoral immunity generating antibodies vaccine antigen. ELISA \nused determine presence Immunoglobulin (Ig) IgG, IgA, IgM \nserum different time points post-vaccination.","code":""},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"principle-of-elisa","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.1.1 Principle of ELISA","text":"ELISA based principle antigen-antibody interaction. antigen must immobilized solid surface complexed enzyme-linked antibody ELISA. conjugated enzyme’s activity evaluated incubating substrate yield quantifiable result, enables detection. four basic steps ELISA:1. Coating multiwell plate antigen/antibody: step depends want detect sample. need evaluate presence antibody, plate coated antigen, vice versa. coat plate, fixed concentration antigen (protein) added 96 well high-binding plate (charged plate). Plate incubated night antigen 4 degree celsius (proteins temperature sensitive) antigens completely bound well.2. Blocking: possible every site well coated targeted antigen, uncovered areas. important block empty spaces primary antibody (add next step) binds spaces give us false positive results. , microplate well surface-binding sites blocked unrelated protein substance.common blocking agents bovine serum albumin, skim milk, casein. One best blocking agents use serum organism secondary (detection antibody) raised. example, secondary antibody raised goat, can use goat serum blocking agent.3. Probing: Probing step add sample containing antibodies want detect. primary antibody. antibodies antigen (coated) present sample, bind antigen high affinity.4. Washing: incubation sample containing primary antibody, wells washed unbound antibody washed away. Washing solution contains phosphate buffer saline + 0.05% tween-20 (mild detergent). 0.05% tween-20 washes away non-specific interactions strong, keeps specific interaction strong detached mild detergent.5. Detection: detect presence antibody-antigen complex, secondary antibody labelled enzyme (usually horseradish peroxidase) added wells, incubated washed.6. Signal Measurement: Finally detect “” “much” antibody present, chromogenic substrate (like 3,3’,5,5’-Tetramethylbenzidine) added wells, can cleaved enzyme tagged secondary antibody. color compund formed addition substrate, directly proportional amount antibody present sample. plate read plate reader, color converted numbers.\nFigure 6.1: caption\n","code":""},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"loading-libraries","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.1.2 Loading libraries","text":"","code":"\nlibrary(readxl)\nlibrary(tidyverse)\nlibrary(minpack.lm)\nlibrary(broom)\nlibrary(purrr)\nlibrary(ggbeeswarm)"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"elisa-data-analysis","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.2 ELISA data analysis","text":"Analysis ELISA data important part ELISA experiment. ELISA data can analyzed different ways based data acquired. examples type ELISA data :1. standard curve: ELISA can used determine concentrations antigen antibody. type ELISA data usually standard curve \ndifferent concentrations known analyte concentration sample determined extrapolating unknown values curve. type assay straightforward, easy interpret robust.2. Without standard curve: Usually vaccine studies involve investigating presence high-affinity (novel) antibodies vaccine antigens.\nTherefore, plotting standard curve feasible previous information available antibody concentration type antibody. Also, antibody response vaccine differ depending individual,\npractical generate calibration curve absolute concentrations can extrapolated.\ntype ELISA, quantification antibody titers performed using serial dilutions test samples, analysis can performed using following three methods (Hartman et al. 2018):Fitting sigmoid modelEndpoint titer method\n3: Absorbance summation methodLet’s look methods, can apply methods data, R-based packages can utilize perform analysis.","code":""},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"fitting-sigmoid-model","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.3 1. Fitting sigmoid model:","text":"model, perform 8-10 point serial dilution sample plot 4 parameter sigmoidal curve.","code":""},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"an-example-of-the-fitting-sigmoid-model-is-below","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.3.1 An example of the fitting sigmoid model is below:","text":"","code":""},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"read-in-the-data","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.3.1.1 Read in the data","text":"","code":"\nelisa_example_data <- read_excel(\"DATA/example_elisa_data.xlsx\")"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"clean-the-data","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.3.1.2 Clean the data","text":"","code":"\n# separate 1/\n\nelisa_example_data <- separate(elisa_example_data, \n                               col = \"dilution\", \n                               into = c(\"numerator\", \"denominator\"), \n                               sep = \"\\\\/\")\n\nelisa_example_data <- elisa_example_data %>% \n  mutate_if(is.character, as.numeric)\n\nelisa_example_data$dilution <- \n  elisa_example_data$numerator/elisa_example_data$denominator  \n\nelisa_example_data <- elisa_example_data %>%\n  mutate(log_dilution = log(dilution, base = 3))\n\nhead(elisa_example_data)## # A tibble: 6 × 5\n##   numerator denominator absorbance dilution log_dilution\n##       <dbl>       <dbl>      <dbl>    <dbl>        <dbl>\n## 1         1          30       4    0.0333          -3.10\n## 2         1          90       3.73 0.0111          -4.10\n## 3         1         270       2.34 0.00370         -5.10\n## 4         1         810       1.1  0.00123         -6.10\n## 5         1        2430       0.51 0.000412        -7.10\n## 6         1        7290       0.22 0.000137        -8.10\nmod_1 <- nlsLM(absorbance ~ \n                 ((a-d)/(1+(log_dilution/c)^b)) + d,\ndata = elisa_example_data, \nstart = list (a = 4, d= 0, c = -5, b = 1))\n\n# a = maximum absorbance\n# d = minimum absobance\n# c = point of maximum growth \n# b = slope at c\n\nmod_1## Nonlinear regression model\n##   model: absorbance ~ ((a - d)/(1 + (log_dilution/c)^b)) + d\n##    data: elisa_example_data\n##        a        d        c        b \n##  4.12406  0.04532 -5.31056  7.62972 \n##  residual sum-of-squares: 0.02221\n## \n## Number of iterations to convergence: 9 \n## Achieved convergence tolerance: 1.49e-08\nsummary(mod_1)## \n## Formula: absorbance ~ ((a - d)/(1 + (log_dilution/c)^b)) + d\n## \n## Parameters:\n##   Estimate Std. Error  t value Pr(>|t|)    \n## a  4.12406    0.05820   70.860 1.75e-12 ***\n## d  0.04532    0.02268    1.998   0.0808 .  \n## c -5.31056    0.03933 -135.037 1.01e-14 ***\n## b  7.62972    0.35854   21.280 2.50e-08 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 0.05269 on 8 degrees of freedom\n## \n## Number of iterations to convergence: 9 \n## Achieved convergence tolerance: 1.49e-08"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"create-a-fitted-sigmoid-model-function-and-apply-the-function-to-the-data","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.3.1.3 Create a fitted sigmoid model function and apply the function to the data","text":"","code":"\ntidy_params <- mod_1 %>% tidy()\n\na <- tidy_params$estimate[tidy_params$term == \"a\"]\nb <- tidy_params$estimate[tidy_params$term == \"b\"]\nc <- tidy_params$estimate[tidy_params$term == \"c\"]\nd <- tidy_params$estimate[tidy_params$term == \"d\"]\n\nelisa_example_data <- elisa_example_data %>%\n  mutate(fitted = predict(mod_1))\n\nelisa_example_data <- elisa_example_data %>%\n  mutate(fitted = predict(mod_1))"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"plot-the-signmoid-curve-with-fitted-sigmoid-model","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.3.1.4 Plot the signmoid curve with fitted sigmoid model","text":"","code":"\nelisa_example_data %>%\n  ggplot(aes(x = log_dilution, y = absorbance)) +\n  geom_point() +\n  geom_line(aes(y=fitted), color = \"dodgerblue\")"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"endpoint-titer-method","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.4 2. Endpoint titer method","text":"endpoint titer approach chooses absorbance value just background noise (lower asymptotic level). highest dilution absorbance greater predetermined value endpoint titer. method based assumption sample higher protein concentration require higher dilution factor achieve absorbance just level background noise.","code":""},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"create-an-endpoint-titer-function-and-apply-it-to-the-output-of-the-fitted-sigmoid-model-values.","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.4.1 Create an endpoint titer function and apply it to the output of the fitted sigmoid model values.","text":"","code":"\nendpoint_titer <- c * (((a - d) / (0.2 - d)) - 1) ^ (1 / b)\n\nsummary(endpoint_titer)##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n##  -8.113  -8.113  -8.113  -8.113  -8.113  -8.113\nendpoint_titer## [1] -8.113285"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"absorbance-summation-method","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.4.2 Absorbance summation method","text":"model data analysis, sum absorbance values sample obtain one value. value termed absorption summation (). Using data, calculated :","code":"\nAS = 0.04 + 0.04 + 0.05 + 0.05 + 0.06 + \n  0.1 + 0.22 + 0.51 + 1.1 + 2.34 + 3.73 + 4.0\n\nAS## [1] 12.24"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"apply-the-fitting-sigmoid-model-and-endpoint-titer-function-in-our-dataset","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.5 Apply the fitting sigmoid model and endpoint titer function in our dataset","text":"presented data mouse study. data, presence IgG antibody evaluated receptor binding domain (RBD) SARS-CoV-2 virus two different groups mice. need elucidate group higher concentration antibodies.","code":""},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"read-in-the-data-1","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.5.0.1 Read in the data","text":"","code":"\nelisa_data <- read_excel(\"DATA/elisa_data_serial_dilution.xlsx\")"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"tidy-the-data","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.5.0.2 Tidy the data","text":"","code":"\nelisa_data <- pivot_longer(data = elisa_data, \n                           cols = \"Mouse_1\":\"Mouse_5\", \n                           names_to = \"mouse_id\", \n                           values_to = \"absorbance\")\n\nhead(elisa_data)## # A tibble: 6 × 4\n##   Groups  Dilution mouse_id absorbance\n##   <chr>   <chr>    <chr>         <dbl>\n## 1 Group 1 1/50     Mouse_1         4.1\n## 2 Group 1 1/50     Mouse_2         3.9\n## 3 Group 1 1/50     Mouse_3         4.3\n## 4 Group 1 1/50     Mouse_4         4.2\n## 5 Group 1 1/50     Mouse_5         4  \n## 6 Group 1 1/100    Mouse_1         3.9\n# separate dilution column and convert it to log2\n\nelisa_data <- separate(elisa_data, \n                       col = \"Dilution\", \n                       into = c(\"numerator\", \n                                \"denomenator\"), \n                       sep = \"\\\\/\")\n\nelisa_data <- elisa_data %>% \n  transform(numerator = as.numeric(numerator),\n            denomenator = as.numeric(denomenator))\n\nelisa_data <- elisa_data %>%\n  mutate(dilution = \n           elisa_data$numerator/elisa_data$denomenator) \n\nelisa_data <- elisa_data %>%\n  mutate(log_dilution = log2(dilution))\n\nhead(elisa_data)##    Groups numerator denomenator mouse_id absorbance dilution log_dilution\n## 1 Group 1         1          50  Mouse_1        4.1     0.02    -5.643856\n## 2 Group 1         1          50  Mouse_2        3.9     0.02    -5.643856\n## 3 Group 1         1          50  Mouse_3        4.3     0.02    -5.643856\n## 4 Group 1         1          50  Mouse_4        4.2     0.02    -5.643856\n## 5 Group 1         1          50  Mouse_5        4.0     0.02    -5.643856\n## 6 Group 1         1         100  Mouse_1        3.9     0.01    -6.643856"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"converting-data-into-dataframe","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.5.0.2.1 converting data into dataframe","text":"","code":"\nelisa_data_df <- elisa_data %>% \n  group_by(Groups, mouse_id) %>% \n  summarize(log_dilution = log_dilution, \n            absorbance = absorbance)## `summarise()` has grouped output by 'Groups', 'mouse_id'. You can override using\n## the `.groups` argument.\nelisa_data_nested <- elisa_data %>%\n  group_by(Groups, mouse_id) %>%\n  nest()\n\nhead(elisa_data_nested)## # A tibble: 6 × 3\n## # Groups:   Groups, mouse_id [6]\n##   Groups  mouse_id data             \n##   <chr>   <chr>    <list>           \n## 1 Group 1 Mouse_1  <tibble [10 × 5]>\n## 2 Group 1 Mouse_2  <tibble [10 × 5]>\n## 3 Group 1 Mouse_3  <tibble [10 × 5]>\n## 4 Group 1 Mouse_4  <tibble [10 × 5]>\n## 5 Group 1 Mouse_5  <tibble [10 × 5]>\n## 6 Group 2 Mouse_1  <tibble [10 × 5]>"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"plot-the-curves-to-evaluate-the-a-d-c-and-b","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.5.0.2.2 plot the curves to evaluate the a, d, c, and b","text":"Based curve, values := 4,\nd = 0\nc = 2\nb = 1","code":"\nelisa_data %>%\n  ggplot(aes(x = log_dilution, y = absorbance)) +\n  geom_point() +\n  geom_line() + \n  facet_wrap(Groups ~ mouse_id)"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"creating-a-function-for-fitting-model","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.5.1 Creating a function for fitting model","text":"","code":"\nfitted_model_elisa <- function(df_elisa, \n                               start_a, start_d, \n                               start_c, start_b) {\n  mod_1 <- nlsLM(absorbance ~ \n                   ((a-d)/(1+(log_dilution/c)^b)) + d,\ndata = df_elisa,\nstart = list(a = start_a, d = start_d, c = start_c, b = start_b))\n  return(mod_1)\n}"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"fitting-the-model-into-the-dataset","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.5.1.1 Fitting the model into the dataset","text":"","code":"\nfitted_model_elisa(elisa_data_nested$data[[1]], \n                   start_a = 4, \n                   start_d = 0, \n                   start_c = -8, \n                   start_b = 1)## Nonlinear regression model\n##   model: absorbance ~ ((a - d)/(1 + (log_dilution/c)^b)) + d\n##    data: df_elisa\n##        a        d        c        b \n##   4.3070  -0.6009 -10.2577   5.2893 \n##  residual sum-of-squares: 0.1199\n## \n## Number of iterations to convergence: 7 \n## Achieved convergence tolerance: 1.49e-08"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"apply-the-fitted-model-function-to-the-whole-dataframe","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.5.1.2 Apply the fitted model function to the whole dataframe","text":"","code":"\nelisa_fitted_data <- elisa_data_nested %>%\n  mutate(fitted_data = \n           purrr::map(data, ~ \n                        fitted_model_elisa(.x,start_a = 4, \n                                              start_d = 0, \n                                              start_c = -8, \n                                              start_b = 1)))\n\nhead(elisa_fitted_data)## # A tibble: 6 × 4\n## # Groups:   Groups, mouse_id [6]\n##   Groups  mouse_id data              fitted_data\n##   <chr>   <chr>    <list>            <list>     \n## 1 Group 1 Mouse_1  <tibble [10 × 5]> <nls>      \n## 2 Group 1 Mouse_2  <tibble [10 × 5]> <nls>      \n## 3 Group 1 Mouse_3  <tibble [10 × 5]> <nls>      \n## 4 Group 1 Mouse_4  <tibble [10 × 5]> <nls>      \n## 5 Group 1 Mouse_5  <tibble [10 × 5]> <nls>      \n## 6 Group 2 Mouse_1  <tibble [10 × 5]> <nls>"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"take-out-the-summary-of-the-data","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.5.1.3 Take out the summary of the data","text":"","code":"\nelisa_fitted_data_summary <- elisa_fitted_data %>%\n  mutate(elisa_fitted_data_summary = \n           purrr::map(fitted_data, broom::glance))\n\nunnested <- elisa_fitted_data_summary %>%\nunnest(elisa_fitted_data_summary) %>%\nungroup() %>%\ndplyr::select(Groups, mouse_id, fitted_data)\n\nunnested$fitted_data[[1]]## Nonlinear regression model\n##   model: absorbance ~ ((a - d)/(1 + (log_dilution/c)^b)) + d\n##    data: df_elisa\n##        a        d        c        b \n##   4.3070  -0.6009 -10.2577   5.2893 \n##  residual sum-of-squares: 0.1199\n## \n## Number of iterations to convergence: 7 \n## Achieved convergence tolerance: 1.49e-08"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"create-function-of-fitted-model-and-endpoint-titer-where-the-output-of-the-fitted-model-data-will-be-the-input-of-the-endpoint-titer","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.6 Create function of Fitted model and endpoint titer, where the output of the fitted model data will be the input of the endpoint titer","text":"","code":"\n# Fitted model function\nfitted_model_elisa <- function(df_elisa, \n                               start_a, \n                               start_d, \n                               start_c, \n                               start_b) {\n  mod_1 <- nlsLM(absorbance ~ \n                   ((a-d)/(1+(log_dilution/c)^b)) + d,\ndata = df_elisa,\nstart = list(a = start_a, d = start_d, c = start_c, b = start_b))\n  return(mod_1)\n}\n\n# Endpoint titer function\n\nendpoint_titer_elisa <- function(fitted_data, back_value) {\n  tidy_fitted <- broom::tidy(fitted_data)\n  est_a <- tidy_fitted$estimate[tidy_fitted$term == \"a\"]\n  est_b <- tidy_fitted$estimate[tidy_fitted$term == \"b\"]\n  est_c <- tidy_fitted$estimate[tidy_fitted$term == \"c\"]\n  est_d <- tidy_fitted$estimate[tidy_fitted$term == \"d\"]\n  endpoint_titer <- est_c * (((est_a - est_d) / (back_value - est_d)) - 1) ^ (1 / est_b)\n  return(endpoint_titer)\n}"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"apply-the-fitted-model-fuction-into-the-nested-data-and-use-the-output-of-the-fitted-data-as-the-input-for-endpoint-titer-value-evaluation","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.6.0.1 Apply the fitted model fuction into the nested data and use the output of the fitted data as the input for endpoint titer value evaluation","text":"","code":""},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"run-fitted-model-on-the-data","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.6.0.1.1 Run fitted model on the data","text":"","code":"\nelisa_data_with_fit_model <- elisa_data_nested %>%\n  mutate(fitted_data = purrr::map(data, \n                                  ~ fitted_model_elisa(.x, start_a = 4, \n                                                          start_d = 0, \n                                                          start_c = -8, \n                                                          start_b = 1)))\n\nhead(elisa_data_with_fit_model)## # A tibble: 6 × 4\n## # Groups:   Groups, mouse_id [6]\n##   Groups  mouse_id data              fitted_data\n##   <chr>   <chr>    <list>            <list>     \n## 1 Group 1 Mouse_1  <tibble [10 × 5]> <nls>      \n## 2 Group 1 Mouse_2  <tibble [10 × 5]> <nls>      \n## 3 Group 1 Mouse_3  <tibble [10 × 5]> <nls>      \n## 4 Group 1 Mouse_4  <tibble [10 × 5]> <nls>      \n## 5 Group 1 Mouse_5  <tibble [10 × 5]> <nls>      \n## 6 Group 2 Mouse_1  <tibble [10 × 5]> <nls>"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"taking-output-of-the-fitted-model-function-and-into-endpoint-titer-function","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.6.0.1.2 Taking output of the fitted model function and into endpoint titer function","text":"","code":"\nelisa_data_with_endpoint_titer <- elisa_data_with_fit_model %>%\n  mutate(endpoint_data = \n           purrr::map(fitted_data, \n                      ~ endpoint_titer_elisa(.x, back_value = 0.2)))"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"plot-the-endpoint-titer-data-for-the-two-groups","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.6.0.2 Plot the endpoint titer data for the two groups","text":"","code":"\nelisa_data_with_endpoint_titer$endpoint_data=\n  as.numeric(elisa_data_with_endpoint_titer$endpoint_data)\n\nelisa_data_with_endpoint_titer %>%\n  ggplot(aes(x = Groups, y = endpoint_data, color = Groups)) +\n geom_beeswarm(cex = 3) "},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"perform-statistical-analysis-on-the-data","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.6.0.3 Perform statistical analysis on the data","text":"","code":"\nelisa_data_stats <- t.test(endpoint_data ~ Groups, \n                           data = elisa_data_with_endpoint_titer)\n\nelisa_data_stats %>%\n  tidy()## # A tibble: 1 × 10\n##   estimate estimate1 estimate2 statistic    p.value parameter conf.low conf.high\n##      <dbl>     <dbl>     <dbl>     <dbl>      <dbl>     <dbl>    <dbl>     <dbl>\n## 1   -0.800     -14.0     -13.2     -18.8 0.00000268      5.63   -0.906    -0.695\n## # … with 2 more variables: method <chr>, alternative <chr>"},{"path":"enzyme-linked-immunosorbest-assay-elisa.html","id":"statistical-data-analysis-for-more-than-two-groups","chapter":"6 Enzyme-linked immunosorbest assay (ELISA)","heading":"6.6.0.4 Statistical data analysis for more than two groups","text":"","code":""},{"path":"elisa-data-processing.html","id":"elisa-data-processing","chapter":"7 ELISA data processing","heading":"7 ELISA data processing","text":"read ELISA plate 96 well plate using plate reader. plate reader generates data form number excel sheet. created pipeline/worksheet bring information excl sheet tidy format created fitted model endpoint titer functions can applied.","code":""},{"path":"elisa-data-processing.html","id":"read-in-the-first-dataset","chapter":"7 ELISA data processing","heading":"7.0.0.1 Read in the first dataset","text":"example ELISA data came straight plate reader. data arranged 96-well plate format contains Optical Density (OD) values.","code":"\nelisa_raw_data <- read_excel(\"DATA/elisa_s1_07-25-20.xlsx\", \n                             sheet = \"S1\", col_names = FALSE,  \n                             range = \"B2:M9\")## New names:\n## * `` -> ...1\n## * `` -> ...2\n## * `` -> ...3\n## * `` -> ...4\n## * `` -> ...5\n## * ...\nhead(elisa_raw_data)## # A tibble: 6 × 12\n##   ...1          ...2  ...3 ...4   ...5  ...6 ...7   ...8  ...9 ...10 ...11 ...12\n##   <chr>        <dbl> <dbl> <chr> <dbl> <dbl> <chr> <dbl> <dbl> <chr> <dbl> <dbl>\n## 1 5.199999999… 0.05  0.069 6.3E… 0.061 0.122 0.16… 0.145 0.135 6.80… 0.053 0.05 \n## 2 7.900000000… 0.098 0.069 6.80… 0.115 0.202 5.89… 0.134 0.069 0.106 0.05  0.075\n## 3 8.899999999… 0.133 0.119 OVRF… 3.87  2.32  OVRF… 3.85  2.12  OVRF… 3.21  1.02 \n## 4 OVRFLW       3.46  1.16  OVRF… 3.80  2.36  OVRF… 3.70  1.49  OVRF… 3.68  1.63 \n## 5 3.815999999… 1.82  0.446 3.89… 3.42  1.13  OVRF… 2.33  0.608 OVRF… 3.41  1.10 \n## 6 OVRFLW       3.69  1.43  OVRF… 3.66  1.27  3.839 1.74  0.444 2.49… 0.637 0.704"},{"path":"elisa-data-processing.html","id":"tidy-dataset-1","chapter":"7 ELISA data processing","heading":"7.0.0.2 Tidy dataset 1","text":"important clean data arrange format can apply formulas functions.","code":"\n# Convert all columns to numeric\n\nelisa_raw_data_numeric <- elisa_raw_data %>% \n  mutate_if(is.character, as.numeric)## Warning in mask$eval_all_mutate(quo): NAs introduced by coercion\n\n## Warning in mask$eval_all_mutate(quo): NAs introduced by coercion\n\n## Warning in mask$eval_all_mutate(quo): NAs introduced by coercion\n\n## Warning in mask$eval_all_mutate(quo): NAs introduced by coercion\n# pivot longer the data\n\nelisa_raw_data_tidy <- pivot_longer(data = elisa_raw_data_numeric, cols = \"...1\":\"...12\", names_to = \"well_id\", values_to = \"od_450nm\")\n\n# remove \"...\" from the first column\n\nelisa_raw_data_tidy$well_id <- str_replace(elisa_raw_data_tidy$well_id, \"...\", \"\")\n\n# Add new column to the data_frame\n\nelisa_raw_data_tidy_new <- elisa_raw_data_tidy %>%\n  mutate(name = rep(LETTERS[1:8], each = 12))\n\nelisa_raw_data_tidy_new <- elisa_raw_data_tidy_new %>%\n  mutate(well_id = paste0(name, well_id)) %>%\n  select(-name)\n\nhead(elisa_raw_data_tidy_new)## # A tibble: 6 × 2\n##   well_id od_450nm\n##   <chr>      <dbl>\n## 1 A1         0.052\n## 2 A2         0.05 \n## 3 A3         0.069\n## 4 A4         0.063\n## 5 A5         0.061\n## 6 A6         0.122"},{"path":"elisa-data-processing.html","id":"read-in-the-second-data-set","chapter":"7 ELISA data processing","heading":"7.0.0.3 Read in the second data set","text":"second dataset contains information groups, mouse id, dilutions respective wells 96 well plate dataset-1.","code":"\nelisa_label_data <- read_excel(\"DATA/elisa_s1_07-25-20.xlsx\", \n                               sheet = \"S1\", col_names = FALSE,  \n                               range = \"Q2:AB9\")## New names:\n## * `` -> ...1\n## * `` -> ...2\n## * `` -> ...3\n## * `` -> ...4\n## * `` -> ...5\n## * ...\nhead(elisa_label_data)## # A tibble: 6 × 12\n##   ...1        ...2   ...3  ...4  ...5  ...6  ...7  ...8  ...9  ...10 ...11 ...12\n##   <chr>       <chr>  <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr> <chr>\n## 1 blank       secon… naïv… 1A-1… 1A-1… 1A-1… 1A-2… 1A-2… 1A-2… 1A-3… 1A-3… 1A-3…\n## 2 1A-4 (1/250 1A-4 … 1A-4… 1B-1… 1B-1… 1B-1… 1B-2… 1B-2… 1B-2… 1B-3… 1B-3… 1B-3…\n## 3 1B-4 (1/250 1B-4 … 1B-4… 2A-1… 2A-1… 2A-1… 2A-2… 2A-2… 2A-2… 2A-3… 2A-3… 2A-3…\n## 4 2B-1 (1/250 2B-1 … 2B-1… 2B-2… 2B-2… 2B-2… 2B-3… 2B-3… 2B-3… 2B-4… 2B-4… 2B-4…\n## 5 3A-1 (1/250 3A-1 … 3A-1… 3A-2… 3A-2… 3A-2… 3A-3… 3A-3… 3A-3… 3A-4… 3A-4… 3A-4…\n## 6 3B-1 (1/250 3B-1 … 3B-1… 3B-2… 3B-2… 3B-2… 3B-3… 3B-3… 3B-3… 3B-4… 3B-4… 3B-4…"},{"path":"elisa-data-processing.html","id":"tidy-dataset-2","chapter":"7 ELISA data processing","heading":"7.0.0.4 Tidy dataset-2","text":"","code":"\n# pivot longer the data\n\nelisa_label_data_tidy <- pivot_longer(data = elisa_label_data, \n                                      cols = \"...1\":\"...12\", \n                                      names_to = \"well_id\", \n                                      values_to = \"information\")\n\n# remove \"...\" from the first column\n\nelisa_label_data_tidy$well_id <- str_replace(elisa_label_data_tidy$well_id, \"...\", \"\")\n\n# Add new column to the data_frame\n\nelisa_label_data_tidy_new <- elisa_label_data_tidy %>%\n  mutate(name = rep(LETTERS[1:8], each = 12))\n\nelisa_label_data_tidy_new <- elisa_label_data_tidy_new %>%\n  mutate(well_id = paste0(name, well_id)) %>%\n  select(-name)\n\nhead(elisa_label_data_tidy_new)## # A tibble: 6 × 2\n##   well_id information  \n##   <chr>   <chr>        \n## 1 A1      blank        \n## 2 A2      secondary    \n## 3 A3      naïve (1/250)\n## 4 A4      1A-1 (1/250  \n## 5 A5      1A-1 (1/1250 \n## 6 A6      1A-1 (1/6250"},{"path":"elisa-data-processing.html","id":"merge-dataset-1-with-od-information-with-dataset-2-with-respective-data-information","chapter":"7 ELISA data processing","heading":"7.0.0.5 Merge dataset-1 (with OD information) with dataset-2 (with respective data information)","text":"create complete full dataset Groups, mouse-id, dilutions, OD, merged dataset-1 dataset-2 together. also cleaned data set mouse-ID dilution columns separate columns.","code":"\n#Merge the two datasets\n\nelisa_data = elisa_raw_data_tidy_new %>% inner_join(elisa_label_data_tidy_new,\n                                                    by=\"well_id\")\n\nhead(elisa_data)## # A tibble: 6 × 3\n##   well_id od_450nm information  \n##   <chr>      <dbl> <chr>        \n## 1 A1         0.052 blank        \n## 2 A2         0.05  secondary    \n## 3 A3         0.069 naïve (1/250)\n## 4 A4         0.063 1A-1 (1/250  \n## 5 A5         0.061 1A-1 (1/1250 \n## 6 A6         0.122 1A-1 (1/6250\n### Separate the information table into sample ID and dilution columns\n\ntidy_elisa_data <- separate(elisa_data, col = \"information\", \n                            into = c(\"sample_id\", \"dilution\"),\n                            sep = \"\\\\(\")## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 2 rows [1, 2].\nhead(tidy_elisa_data)## # A tibble: 6 × 4\n##   well_id od_450nm sample_id   dilution\n##   <chr>      <dbl> <chr>       <chr>   \n## 1 A1         0.052 \"blank\"     <NA>    \n## 2 A2         0.05  \"secondary\" <NA>    \n## 3 A3         0.069 \"naïve \"    1/250)  \n## 4 A4         0.063 \"1A-1 \"     1/250   \n## 5 A5         0.061 \"1A-1 \"     1/1250  \n## 6 A6         0.122 \"1A-1 \"     1/6250\ntidy_elisa_data <- tidy_elisa_data %>%\n  mutate(dilution = str_extract(dilution, \"(/)[0-9]+\"),\n         dilution = str_replace(dilution, \"/\", \"\"),\n         dilution = as.numeric(dilution))\n\ntidy_elisa_data <- tidy_elisa_data %>%\n  select(well_id, sample_id, dilution, od_450nm)\n\nhead(tidy_elisa_data)## # A tibble: 6 × 4\n##   well_id sample_id   dilution od_450nm\n##   <chr>   <chr>          <dbl>    <dbl>\n## 1 A1      \"blank\"           NA    0.052\n## 2 A2      \"secondary\"       NA    0.05 \n## 3 A3      \"naïve \"         250    0.069\n## 4 A4      \"1A-1 \"          250    0.063\n## 5 A5      \"1A-1 \"         1250    0.061\n## 6 A6      \"1A-1 \"         6250    0.122"},{"path":"flow-cytometry.html","id":"flow-cytometry","chapter":"8 Flow cytometry","heading":"8 Flow cytometry","text":"Flow cytometery data can quantified many different ways different techniques. purpose data analyses, manual gating achieved FlowJo cell frequencies populations exported .csv file. .csv file primary input R pipeline aims output box plots gated cell population.example data set innate response study whcih investigated immune response lungs first 28 days infection.","code":""},{"path":"flow-cytometry.html","id":"loading-packages","chapter":"8 Flow cytometry","heading":"8.1 Loading packages","text":"","code":"\nlibrary(readxl)\nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(dplyr)\nlibrary(tidyverse)\nlibrary(scales)## \n## Attaching package: 'scales'## The following object is masked from 'package:purrr':\n## \n##     discard## The following object is masked from 'package:readr':\n## \n##     col_factor\nlibrary(stringr)\nlibrary(tidyr)\nlibrary(knitr)\nlibrary(forcats)\nlibrary(broom)\nlibrary(ggfortify)\nlibrary(stats)\nlibrary(ggpubr)\nlibrary(grDevices)\nlibrary(rstatix)## \n## Attaching package: 'rstatix'## The following object is masked from 'package:stats':\n## \n##     filter\nlibrary(writexl)"},{"path":"flow-cytometry.html","id":"panel-information","chapter":"8 Flow cytometry","heading":"8.2 panel information","text":"","code":"\n# antibody_panel <- read_excel"},{"path":"flow-cytometry.html","id":"loading-data","chapter":"8 Flow cytometry","heading":"8.3 Loading data","text":"","code":"\nDf <- read_excel(\"DATA/innate_normalizedto45.xlsx\", sheet = \"CD3CD11b No Day 14\")\n\nmarker_legend <- read_excel(\"DATA/marker legend.xlsx\")\n\n# Remove Freq of Parent columns\nDf1 <- Df %>% \n  select(-matches(\"Parent\"))\n# Remove \"Leukocytes/LIVE/Single Cells/\" from col names\nnames(Df1) <- str_remove(names(Df1), \"Leukocytes/LIVE/Single Cells/\")\n\nDf1 <- Df1 %>%\n  rename_all(funs(str_replace(., \"\\\\|.+\", \"\")))# Remove \"|Freq of...\" from col names## Warning: `funs()` was deprecated in dplyr 0.8.0.\n## Please use a list of either functions or lambdas: \n## \n##   # Simple named list: \n##   list(mean = mean, median = median)\n## \n##   # Auto named with `tibble::lst()`: \n##   tibble::lst(mean, median)\n## \n##   # Using lambdas\n##   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))\n## This warning is displayed once every 8 hours.\n## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.\nDf1 <- Df1 %>%\n  rename_all(funs(str_replace_all(., \"\\\\/Q[:digit:]+\\\\:\", \"\"))) %>%\n  rename_all(funs(str_replace(., \"\\\\/\", \" \"))) %>%\n  rename_all(funs(str_replace(., \"\\\\,\", \" \"))) %>%\n  rename_all(funs(str_replace(., \"\\\\ \\\\,\", \" \")))\n\n# str_extract_all(names(Df1), \"[:alpha:]+[:digit:]+[\\\\+\\\\-]\")\n# \n# \n# \n# \n# \n# \n# marker_select <- function(col_title) {\n#   marker_df <- str_detect(names(DATA1), \"[\\\\+\\\\-]\") \n#   return(marker_df)\n# }"},{"path":"flow-cytometry.html","id":"making-the-data-tidy-for-plotting","chapter":"8 Flow cytometry","heading":"8.4 Making the data tidy for plotting","text":"","code":"\ntidy_Df1 <- pivot_longer(data = Df1, cols =  starts_with(\"CD45+\"), names_to = \"cell_types\", values_to = \"percentage_of_CD45\") \n\ntidy_Df1 <- tidy_Df1 %>%\n  separate(col = \"SAMPLE\", into = c(\"day\", \"replicate\"))\n\n\ntidy_Df1 %>%\n  select(cell_types) %>%\n  unique()## # A tibble: 128 × 1\n##    cell_types                          \n##    <chr>                               \n##  1 \"CD45+ \"                            \n##  2 \"CD45+ CD3-   CD11b+ \"              \n##  3 \"CD45+ CD3-   CD11b+ CD25+ \"        \n##  4 \"CD45+ CD3-   CD11b+ CD103+ \"       \n##  5 \"CD45+ CD3-   CD11b+ gamma_delta \"  \n##  6 \"CD45+ CD3-   CD11b+ NKp46+ \"       \n##  7 \"CD45+ CD3-   CD11b+ CD11c+  CD64- \"\n##  8 \"CD45+ CD3-   CD11b+ CD11c-  CD64- \"\n##  9 \"CD45+ CD3-   CD11b+ CD86-  CD64+ \" \n## 10 \"CD45+ CD3-   CD11b+ CD86+  CD64+ \" \n## # … with 118 more rows\ntidy_Df1 <- tidy_Df1 %>%\n  filter(percentage_of_CD45 > 0.005)\n\nhead(tidy_Df1, n=10)## # A tibble: 10 × 4\n##    day   replicate cell_types                           percentage_of_CD45\n##    <chr> <chr>     <chr>                                             <dbl>\n##  1 CNT   1         \"CD45+ \"                                          82.9 \n##  2 CNT   1         \"CD45+ CD3-   CD11b+ \"                            29.3 \n##  3 CNT   1         \"CD45+ CD3-   CD11b+ CD25+ \"                       0.88\n##  4 CNT   1         \"CD45+ CD3-   CD11b+ CD103+ \"                      0.75\n##  5 CNT   1         \"CD45+ CD3-   CD11b+ gamma_delta \"                 4.77\n##  6 CNT   1         \"CD45+ CD3-   CD11b+ NKp46+ \"                      7.3 \n##  7 CNT   1         \"CD45+ CD3-   CD11b+ CD11c+  CD64- \"               3.65\n##  8 CNT   1         \"CD45+ CD3-   CD11b+ CD11c-  CD64- \"              24.3 \n##  9 CNT   1         \"CD45+ CD3-   CD11b+ CD86-  CD64+ \"                0.43\n## 10 CNT   1         \"CD45+ CD3-   CD11b+ CD86+  CD64+ \"                0.85\n# Select CD3 & CD11b populations and create new data frames \n \nCD3pos_CD11bneg <- tidy_Df1 %>%\n  filter(str_detect(cell_types, \"CD3\\\\+ + CD11b\\\\-\")) \n\nCD3neg_CD11bpos <- tidy_Df1 %>%\n  filter(str_detect(cell_types, \"CD3\\\\- + CD11b\\\\+\")) \n\nCD3neg_CD11bneg <- tidy_Df1 %>%\n  filter(str_detect(cell_types, \"CD3\\\\- + CD11b\\\\-\"))"},{"path":"flow-cytometry.html","id":"boxplot","chapter":"8 Flow cytometry","heading":"8.5 boxplot","text":"","code":"\nCD3pos_CD11bneg_bar_plot <- CD3pos_CD11bneg %>%\nmutate(day = fct_relevel(day,\n            \"CNT\", \"D3\", \"D7\",\n            \"D28\")) %>%\n  ggplot(aes(x = day, y = percentage_of_CD45, fill= day)) +\n  stat_boxplot( aes(day, percentage_of_CD45), \n    geom='errorbar', linetype=1, width=0.5)+  \n  geom_boxplot(aes(day, percentage_of_CD45)) + \n  facet_wrap(~cell_types, scale = \"free_y\", labeller = label_wrap_gen(width=15), ncol = 5, nrow = 20) + \n  theme_bw() + \n  theme(axis.text.x = element_blank(), axis.text.y = element_text(size = 20), \n        axis.title.x = element_text(size = 20, face = \"bold\"), \n        axis.title.y = element_text(size = 20, face = \"bold\"), \n        legend.text = element_text(size = 20), \n        legend.title = element_text(size = 20), \n        plot.title = element_text(color=\"black\", size=30, face=\"bold\")) + \n  labs (y=\"Percentage of CD45\", x = \"Day\") + \n  theme(strip.text = element_text(size=12, face = \"bold\")) + theme(legend.position=\"bottom\") +\n  ggtitle(\"Changes in immune cell populations (lung) CD3+ CD11b-\") +\n  stat_compare_means(label = \"p.signif\", method = \"t.test\",\n                     ref.group = \"CNT\")\n\n\n\nCD3neg_CD11bpos_bar_plot <- CD3neg_CD11bpos %>%\nmutate(day = fct_relevel(day, \n            \"CNT\", \"D3\", \"D7\", \n            \"D28\")) %>%\n  ggplot(aes(x = day, y = percentage_of_CD45, fill= day)) +\n  stat_boxplot( aes(day, percentage_of_CD45), \n    geom='errorbar', linetype=1, width=0.5)+  \n  geom_boxplot( aes(day, percentage_of_CD45)) + \n  facet_wrap(~cell_types, scale = \"free_y\", labeller = label_wrap_gen(width=15), ncol = 5, nrow = 20) + \n  theme_bw() + \n  theme(axis.text.x = element_blank(), axis.text.y = element_text(size = 20), \n        axis.title.x = element_text(size = 20, face = \"bold\"), \n        axis.title.y = element_text(size = 20, face = \"bold\"), \n        legend.text = element_text(size = 20), \n        legend.title = element_text(size = 20), \n        plot.title = element_text(color=\"black\", size=30, face=\"bold\")) + \n  labs (y=\"Percentage of CD45\", x = \"Day\") + \n  theme(strip.text = element_text(size=12, face = \"bold\")) + theme(legend.position=\"bottom\") +\n  ggtitle(\"Changes in immune cell populations (lung) CD3- CD11b+\") +\n  stat_compare_means(label = \"p.signif\", method = \"t.test\",\n                     ref.group = \"CNT\")\n\n\n\nCD3neg_CD11bneg_bar_plot <- CD3neg_CD11bneg %>%\nmutate(day = fct_relevel(day, \n            \"CNT\", \"D3\", \"D7\", \n            \"D28\")) %>%\n  ggplot(aes(x = day, y = percentage_of_CD45, fill= day)) +\n  stat_boxplot( aes(day, percentage_of_CD45), \n    geom='errorbar', linetype=1, width=0.5)+  \n  geom_boxplot( aes(day, percentage_of_CD45)) + \n  facet_wrap(~cell_types, scale = \"free_y\", labeller = label_wrap_gen(width=15), ncol = 5, nrow = 20) + \n  theme_bw() + \n  theme(axis.text.x = element_blank(), axis.text.y = element_text(size = 20), \n        axis.title.x = element_text(size = 20, face = \"bold\"), \n        axis.title.y = element_text(size = 20, face = \"bold\"), \n        legend.text = element_text(size = 20), \n        legend.title = element_text(size = 20), \n        plot.title = element_text(color=\"black\", size=30, face=\"bold\")) + \n  labs (y=\"Percentage of CD45\", x = \"Day\") + \n  theme(strip.text = element_text(size=12, face = \"bold\")) + theme(legend.position=\"bottom\") +\n  ggtitle(\"Changes in immune cell populations (lung) CD3- CD11b-\") +\n  stat_compare_means(label = \"p.signif\", method = \"t.test\",\n                     ref.group = \"CNT\")\n\nCD3pos_CD11bneg_bar_plot\n# CD3neg_CD11bpos_bar_plot\n# CD3neg_CD11bneg_bar_plot"},{"path":"pathology.html","id":"pathology","chapter":"9 Pathology","heading":"9 Pathology","text":"","code":""},{"path":"pathology-1.html","id":"pathology-1","chapter":"10 Pathology","heading":"10 Pathology","text":"","code":""},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
