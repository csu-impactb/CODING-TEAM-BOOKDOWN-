<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Colony forming units to determine bacterial counts | ImpactTB/BAA: Standard Operating Procedures for Data Analysis</title>
  <meta name="description" content="A comprehensive guide to wet lab data collection, sample processing, and computational tool creation for robust and efficient data analysis and dissemination." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Colony forming units to determine bacterial counts | ImpactTB/BAA: Standard Operating Procedures for Data Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A comprehensive guide to wet lab data collection, sample processing, and computational tool creation for robust and efficient data analysis and dissemination." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Colony forming units to determine bacterial counts | ImpactTB/BAA: Standard Operating Procedures for Data Analysis" />
  
  <meta name="twitter:description" content="A comprehensive guide to wet lab data collection, sample processing, and computational tool creation for robust and efficient data analysis and dissemination." />
  

<meta name="author" content="Colorado State University Coding Team" />


<meta name="date" content="2022-08-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mouse-weights.html"/>
<link rel="next" href="enzyme-linked-immunosorbest-assay-elisa.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bookdown CSU Coding Team Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#about-the-project"><i class="fa fa-check"></i><b>1.1</b> About the project</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i><b>1.2</b> About this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="experimental-metadata.html"><a href="experimental-metadata.html"><i class="fa fa-check"></i><b>2</b> Experimental metadata</a></li>
<li class="chapter" data-level="3" data-path="initial-mouse-characteristics.html"><a href="initial-mouse-characteristics.html"><i class="fa fa-check"></i><b>3</b> Initial mouse characteristics</a></li>
<li class="chapter" data-level="4" data-path="mouse-weights.html"><a href="mouse-weights.html"><i class="fa fa-check"></i><b>4</b> Mouse Weights</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="mouse-weights.html"><a href="mouse-weights.html#overview-1"><i class="fa fa-check"></i><b>4.0.1</b> Overview</a></li>
<li class="chapter" data-level="4.0.2" data-path="mouse-weights.html"><a href="mouse-weights.html#parameters"><i class="fa fa-check"></i><b>4.0.2</b> Parameters</a></li>
<li class="chapter" data-level="4.0.3" data-path="mouse-weights.html"><a href="mouse-weights.html#read-in-data"><i class="fa fa-check"></i><b>4.0.3</b> Read in data</a></li>
<li class="chapter" data-level="4.0.4" data-path="mouse-weights.html"><a href="mouse-weights.html#can-also-use-rio-to-read-in-the-data-more-streamlined"><i class="fa fa-check"></i><b>4.0.4</b> Can also use rio to read in the data, more streamlined</a></li>
<li class="chapter" data-level="4.0.5" data-path="mouse-weights.html"><a href="mouse-weights.html#clean-data"><i class="fa fa-check"></i><b>4.0.5</b> Clean data</a></li>
<li class="chapter" data-level="4.0.6" data-path="mouse-weights.html"><a href="mouse-weights.html#body-weight-over-time-graph-and-statistics"><i class="fa fa-check"></i><b>4.0.6</b> Body weight over time graph and statistics</a></li>
<li class="chapter" data-level="4.0.7" data-path="mouse-weights.html"><a href="mouse-weights.html#weight-loss-over-time-graph-and-statistics"><i class="fa fa-check"></i><b>4.0.7</b> Weight loss over time graph and statistics</a></li>
<li class="chapter" data-level="4.0.8" data-path="mouse-weights.html"><a href="mouse-weights.html#weight-vs-cfu"><i class="fa fa-check"></i><b>4.0.8</b> Weight vs CFU</a></li>
<li class="chapter" data-level="4.0.9" data-path="mouse-weights.html"><a href="mouse-weights.html#weight-vs-elisa-results"><i class="fa fa-check"></i><b>4.0.9</b> Weight vs ELISA results</a></li>
<li class="chapter" data-level="4.0.10" data-path="mouse-weights.html"><a href="mouse-weights.html#weight-vs-lesion-burden"><i class="fa fa-check"></i><b>4.0.10</b> Weight vs lesion burden</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html"><i class="fa fa-check"></i><b>5</b> Colony forming units to determine bacterial counts</a>
<ul>
<li class="chapter" data-level="5.1" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html#data-description"><i class="fa fa-check"></i><b>5.1</b> Data description</a></li>
<li class="chapter" data-level="5.2" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html#read-in-data-1"><i class="fa fa-check"></i><b>5.2</b> Read in data</a></li>
<li class="chapter" data-level="5.3" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html#example-one"><i class="fa fa-check"></i><b>5.3</b> Example one</a></li>
<li class="chapter" data-level="5.4" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html#exploratory-analysis-and-quality-checks"><i class="fa fa-check"></i><b>5.4</b> Exploratory analysis and quality checks</a></li>
<li class="chapter" data-level="5.5" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html#exploratory-analysis"><i class="fa fa-check"></i><b>5.5</b> Exploratory analysis</a></li>
<li class="chapter" data-level="5.6" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html#identify-a-good-dilution-for-each-sample"><i class="fa fa-check"></i><b>5.6</b> Identify a good dilution for each sample</a></li>
<li class="chapter" data-level="5.7" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html#calculate-cfus-from-best-dilutionestimate-bacterial-load-for-each-sample-based-on-good-dilution"><i class="fa fa-check"></i><b>5.7</b> Calculate CFUs from best dilution/Estimate bacterial load for each sample based on good dilution</a></li>
<li class="chapter" data-level="5.8" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html#create-initial-report-information-for-these-data"><i class="fa fa-check"></i><b>5.8</b> Create initial report information for these data</a></li>
<li class="chapter" data-level="5.9" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html#sample-anova"><i class="fa fa-check"></i><b>5.9</b> Sample ANOVA</a></li>
<li class="chapter" data-level="5.10" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html#save-processed-data-to-database"><i class="fa fa-check"></i><b>5.10</b> Save processed data to database</a></li>
<li class="chapter" data-level="5.11" data-path="colony-forming-units-to-determine-bacterial-counts.html"><a href="colony-forming-units-to-determine-bacterial-counts.html#example-two"><i class="fa fa-check"></i><b>5.11</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html"><i class="fa fa-check"></i><b>6</b> Enzyme-linked immunosorbest assay (ELISA)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#read-in-data-from-excel-file"><i class="fa fa-check"></i><b>6.1</b> Read in data from excel file</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#tidy-the-data"><i class="fa fa-check"></i><b>6.1.1</b> Tidy the data</a></li>
<li class="chapter" data-level="6.1.2" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#read-in-second-data-set"><i class="fa fa-check"></i><b>6.1.2</b> Read in second data set</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#join-the-od-table-with-the-information-table"><i class="fa fa-check"></i><b>6.2</b> #Join the OD table with the information table</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#separate-the-information-table-into-sample-id-and-dilution-columns"><i class="fa fa-check"></i><b>6.2.1</b> Separate the information table into sample ID and dilution columns</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#elisa-data-analysis-optimization"><i class="fa fa-check"></i><b>6.3</b> ELISA data analysis optimization</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#fitting-sigmoid-model"><i class="fa fa-check"></i><b>6.3.1</b> <strong>1. Fitting sigmoid model:</strong></a></li>
<li class="chapter" data-level="6.3.2" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#endpoint-titer-method"><i class="fa fa-check"></i><b>6.3.2</b> 2. Endpoint titer method</a></li>
<li class="chapter" data-level="6.3.3" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#absorbance-summation-method"><i class="fa fa-check"></i><b>6.3.3</b> Absorbance summation method</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#use-the-the-data-analysis-models-in-our-data"><i class="fa fa-check"></i><b>6.4</b> Use the the data analysis models in our data</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#read-in-the-data"><i class="fa fa-check"></i><b>6.4.1</b> read in the data</a></li>
<li class="chapter" data-level="6.4.2" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#make-the-tidy-data"><i class="fa fa-check"></i><b>6.4.2</b> make the tidy data</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#creating-a-function-for-fitting-model"><i class="fa fa-check"></i><b>6.5</b> Creating a function for fitting model</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#fitting-the-model-into-the-data"><i class="fa fa-check"></i><b>6.5.1</b> Fitting the model into the data</a></li>
<li class="chapter" data-level="6.5.2" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#apply-the-fitted-model-function-to-the-whole-dataframe"><i class="fa fa-check"></i><b>6.5.2</b> Apply the fitted model function to the whole dataframe</a></li>
<li class="chapter" data-level="6.5.3" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#take-out-the-summary-of-the-data"><i class="fa fa-check"></i><b>6.5.3</b> Take out the summary of the data</a></li>
<li class="chapter" data-level="6.5.4" data-path="enzyme-linked-immunosorbest-assay-elisa.html"><a href="enzyme-linked-immunosorbest-assay-elisa.html#creating-a-function-for-endpoint-titer-model-and-fitting-the-model-into-the-data"><i class="fa fa-check"></i><b>6.5.4</b> Creating a function for endpoint titer model and fitting the model into the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="flow-cytometry.html"><a href="flow-cytometry.html"><i class="fa fa-check"></i><b>7</b> Flow cytometry</a>
<ul>
<li class="chapter" data-level="7.1" data-path="flow-cytometry.html"><a href="flow-cytometry.html#loading-packages"><i class="fa fa-check"></i><b>7.1</b> Loading packages</a></li>
<li class="chapter" data-level="7.2" data-path="flow-cytometry.html"><a href="flow-cytometry.html#panel-information"><i class="fa fa-check"></i><b>7.2</b> panel information</a></li>
<li class="chapter" data-level="7.3" data-path="flow-cytometry.html"><a href="flow-cytometry.html#loading-data"><i class="fa fa-check"></i><b>7.3</b> Loading data</a></li>
<li class="chapter" data-level="7.4" data-path="flow-cytometry.html"><a href="flow-cytometry.html#making-the-data-tidy-for-plotting"><i class="fa fa-check"></i><b>7.4</b> Making the data tidy for plotting</a></li>
<li class="chapter" data-level="7.5" data-path="flow-cytometry.html"><a href="flow-cytometry.html#boxplot"><i class="fa fa-check"></i><b>7.5</b> boxplot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ImpactTB/BAA: Standard Operating Procedures for Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="colony-forming-units-to-determine-bacterial-counts" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Colony forming units to determine bacterial counts<a href="colony-forming-units-to-determine-bacterial-counts.html#colony-forming-units-to-determine-bacterial-counts" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="data-description" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Data description<a href="colony-forming-units-to-determine-bacterial-counts.html#data-description" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The data are collected in a spreadsheet with multiple sheets. The first sheet
(named “[x]”) is used to record some metadata for the experiment, while the
following sheets are used to record CFUs counts from the plates used for samples
from each organ, with one sheet per organ. For example, if you plated data
from both the lung and spleen, there would be three sheets in the file: one
with the metadata, one with the plate counts for the lung, and one with the
plate counts for the spleen.</p>
<p>The metadata sheet is used to record information about the overall process of
plating the data. Values from this sheet will be used in calculating the bacterial
load in the original sample based on the CFU counts. This spreadsheet includes
the following columns:</p>
<ul>
<li><code>organ</code>: Include one row for each organ that was plated in the experiment.
You should name the organ all in lowercase (e.g., “lung,” “spleen”). You
should use the same name to also name the sheet that records data for that organ
for example, if you have rows in the metadata sheet for “lung” and “spleen,”
then you should have two other sheets in the file, one sheet named “lung” and
one named “spleen,” which you’ll use to store the plate counts for each of those
organs.</li>
<li><code>prop_resuspended</code>: In this column, give the proportion of that organ that
was plated. For example, if you plated half the lung, then in the “lung” row
of this spread sheet, you should put 0.5 in the <code>prop_resuspended</code> column.</li>
<li><code>total_resuspended_uL</code>: This column contains an original volume of tissue homogenate. For example, raw lung tissue is homogenized in 500 uL of PBS in a tube containing metal beads.</li>
<li><code>og_aliquot_uL</code>: 100 uL of th total_resuspended slurry would be considered an original aliquot and is used to peform serial dilutions.</li>
<li><code>dilution_factor</code>: Amount of the original stock solution that is present in the total solution, after dilution(s)</li>
<li><code>plated_uL</code>: Amount of suspension + diluent plated on section of solid agar</li>
</ul>
</div>
<div id="read-in-data-1" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Read in data<a href="colony-forming-units-to-determine-bacterial-counts.html#read-in-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb10-2"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb10-3"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb10-4"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb10-5"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb10-6"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-7"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb10-8"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-9"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb10-10"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace w/ path to CFU sheet</span></span>
<span id="cb10-12"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-12" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DATA/Copy of baa_cfu_sheet.xlsx&quot;</span>)</span>
<span id="cb10-13"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-14" aria-hidden="true" tabindex="-1"></a>sheet_names <span class="ot">&lt;-</span> <span class="fu">excel_sheets</span>(path)</span>
<span id="cb10-15"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-15" aria-hidden="true" tabindex="-1"></a>sheet_names <span class="ot">&lt;-</span> sheet_names[<span class="sc">!</span>sheet_names <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;metadata&quot;</span>)]</span>
<span id="cb10-16"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-17" aria-hidden="true" tabindex="-1"></a>merged_data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb10-18"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sheet_names)){</span>
<span id="cb10-20"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-21"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-21" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(path, <span class="at">sheet =</span> sheet_names[i]) <span class="sc">%&gt;%</span> </span>
<span id="cb10-22"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">organ =</span> <span class="fu">paste0</span>(sheet_names[i]))</span>
<span id="cb10-23"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-24"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-24" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb10-25"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">#mutate(missing_col = NA) %&gt;% </span></span>
<span id="cb10-26"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_if</span>(is.double, as.numeric) <span class="sc">%&gt;%</span> </span>
<span id="cb10-27"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_if</span>(is.numeric, as.character) <span class="sc">%&gt;%</span> </span>
<span id="cb10-28"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">&quot;dil_&quot;</span>), <span class="at">names_to =</span> <span class="st">&quot;dilution&quot;</span>,</span>
<span id="cb10-29"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">&quot;CFUs&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-30"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dilution =</span> <span class="fu">str_extract</span>(dilution, <span class="st">&quot;[0-9]+&quot;</span>),</span>
<span id="cb10-31"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">dilution =</span> <span class="fu">as.numeric</span>(dilution))</span>
<span id="cb10-32"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-33"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-34"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-34" aria-hidden="true" tabindex="-1"></a>  merged_data[[i]] <span class="ot">&lt;-</span> data</span>
<span id="cb10-35"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-36"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-37"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-38"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-39"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-39" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(merged_data, <span class="at">.id =</span> <span class="st">&quot;column_label&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-40"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>column_label)</span>
<span id="cb10-41"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-42"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(merged_data)</span></code></pre></div>
<pre><code>## [[1]]
## # A tibble: 342 × 8
##    count_date           who_plated who_counted groups mouse organ dilution CFUs 
##    &lt;chr&gt;                &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
##  1 &quot;\&quot;February 21 2022… BK         BK          group… A     lung         0 TNTC 
##  2 &quot;\&quot;February 21 2022… BK         BK          group… A     lung         1 TNTC 
##  3 &quot;\&quot;February 21 2022… BK         BK          group… A     lung         2 TNTC 
##  4 &quot;\&quot;February 21 2022… BK         BK          group… A     lung         3 53   
##  5 &quot;\&quot;February 21 2022… BK         BK          group… A     lung         4 9    
##  6 &quot;\&quot;February 21 2022… BK         BK          group… A     lung         5 4    
##  7 &quot;\&quot;February 21 2022… BK         BK          group… A     lung         6 2    
##  8 &quot;\&quot;February 21 2022… BK         BK          group… A     lung         7 1    
##  9 &quot;\&quot;February 21 2022… BK         BK          group… A     lung         8 0    
## 10 &quot;\&quot;February 21 2022… BK         BK          group… B     lung         0 TNTC 
## # … with 332 more rows
## 
## [[2]]
## # A tibble: 112 × 8
##    count_date          who_plated who_counted groups  mouse organ dilution CFUs 
##    &lt;chr&gt;               &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
##  1 &quot;\&quot;April 25 2022\&quot;&quot; JR         JR          group_1 A     sple…        0 TNTC 
##  2 &quot;\&quot;April 25 2022\&quot;&quot; JR         JR          group_1 A     sple…        1 TNTC 
##  3 &quot;\&quot;April 25 2022\&quot;&quot; JR         JR          group_1 A     sple…        2 53   
##  4 &quot;\&quot;April 25 2022\&quot;&quot; JR         JR          group_1 A     sple…        3 9    
##  5 &quot;\&quot;April 25 2022\&quot;&quot; JR         JR          group_1 A     sple…        4 4    
##  6 &quot;\&quot;April 25 2022\&quot;&quot; JR         JR          group_1 A     sple…        5 2    
##  7 &quot;\&quot;April 25 2022\&quot;&quot; JR         JR          group_1 A     sple…        6 1    
##  8 &quot;\&quot;April 25 2022\&quot;&quot; JR         JR          group_1 A     sple…        7 0    
##  9 &quot;\&quot;April 25 2022\&quot;&quot; JR         JR          group_1 B     sple…        0 TNTC 
## 10 &quot;\&quot;April 25 2022\&quot;&quot; JR         JR          group_1 B     sple…        1 TNTC 
## # … with 102 more rows</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##   count_date            who_plated who_counted groups mouse organ dilution CFUs 
##   &lt;chr&gt;                 &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
## 1 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         0 TNTC 
## 2 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         1 TNTC 
## 3 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         2 TNTC 
## 4 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         3 53   
## 5 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         4 9    
## 6 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         5 4</code></pre>
</div>
<div id="example-one" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Example one<a href="colony-forming-units-to-determine-bacterial-counts.html#example-one" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="exploratory-analysis-and-quality-checks" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Exploratory analysis and quality checks<a href="colony-forming-units-to-determine-bacterial-counts.html#exploratory-analysis-and-quality-checks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="exploratory-analysis" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Exploratory analysis<a href="colony-forming-units-to-determine-bacterial-counts.html#exploratory-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Dimensions of input data:</strong></p>
<p>Based on the input data, data were collected for the following organ or
organs:</p>
<p>The following number of mice were included for each:</p>
<p>The following number of replicates were recorded at each count date for
each experimental group:</p>
<p>The following number of dilutions and dilution level were recorded for
each organ:</p>
<p><strong>People who plated and collected the data. Date or dates of counting:</strong></p>
<p>Based on the input data, the plates included in these data were counted by
the following person or persons:
Based on the input data, the plates included in these data were counted on
the following date or dates:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb14-1" aria-hidden="true" tabindex="-1"></a>all_data <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(organ, who_plated, who_counted, count_date) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##   organ  who_plated who_counted count_date            
##   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;                 
## 1 lung   BK         BK          &quot;\&quot;February 21 2022\&quot;&quot;
## 2 lung   BK         BK          &quot;\&quot;April 18 2022\&quot;&quot;   
## 3 spleen JR         JR          &quot;\&quot;April 25 2022\&quot;&quot;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(all_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##   count_date            who_plated who_counted groups mouse organ dilution CFUs 
##   &lt;chr&gt;                 &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;
## 1 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         0 TNTC 
## 2 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         1 TNTC 
## 3 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         2 TNTC 
## 4 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         3 53   
## 5 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         4 9    
## 6 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         5 4</code></pre>
<p><strong>Distribution of CFUs at each dilution:</strong></p>
<p>Here’s a plot that shows how many plates were too numerous to count at each
dilution level:</p>
<p>Here is a plot that shows how the CFU counts were distributed by dilution
level in the data:</p>
</div>
<div id="identify-a-good-dilution-for-each-sample" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Identify a good dilution for each sample<a href="colony-forming-units-to-determine-bacterial-counts.html#identify-a-good-dilution-for-each-sample" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make all_data into tidy data and filter for CFUs between 10-75</span></span>
<span id="cb18-2"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-3"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb18-3" aria-hidden="true" tabindex="-1"></a>tidy_cfu_data <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dilution =</span> <span class="fu">str_extract</span>(dilution, <span class="st">&quot;[0-9]+&quot;</span>),</span>
<span id="cb18-5"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb18-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">dilution =</span> <span class="fu">as.numeric</span>(dilution)) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((CFUs <span class="sc">&gt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> CFUs <span class="sc">&lt;=</span> <span class="dv">95</span>) <span class="sc">|</span> groups <span class="sc">==</span> <span class="st">&quot;control&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CFUs =</span> <span class="fu">as.numeric</span>(CFUs)) </span>
<span id="cb18-8"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tidy_cfu_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##   count_date            who_plated who_counted groups mouse organ dilution  CFUs
##   &lt;chr&gt;                 &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
## 1 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         3    53
## 2 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         4     9
## 3 &quot;\&quot;February 21 2022\… BK         BK          group… C     lung         5     8
## 4 &quot;\&quot;February 21 2022\… BK         BK          group… D     lung         3    53
## 5 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         2    92
## 6 &quot;\&quot;February 21 2022\… BK         BK          group… A     lung         4     7</code></pre>
</div>
<div id="calculate-cfus-from-best-dilutionestimate-bacterial-load-for-each-sample-based-on-good-dilution" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Calculate CFUs from best dilution/Estimate bacterial load for each sample based on good dilution<a href="colony-forming-units-to-determine-bacterial-counts.html#calculate-cfus-from-best-dilutionestimate-bacterial-load-for-each-sample-based-on-good-dilution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating CFU/ml for every qualifying replicate between 10-75 CFUs. Column binding by organ name to the metadata sheet via inner_join().</span></span>
<span id="cb20-2"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb20-2" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(path, <span class="at">sheet =</span> <span class="st">&quot;metadata&quot;</span>)</span>
<span id="cb20-3"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb20-4" aria-hidden="true" tabindex="-1"></a>tidy_cfu_meta_joined <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(meta, tidy_cfu_data) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(groups) <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CFUs_per_ml =</span> (CFUs <span class="sc">*</span> (dilution_factor<span class="sc">^</span>dilution) <span class="sc">*</span> </span>
<span id="cb20-7"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb20-7" aria-hidden="true" tabindex="-1"></a>                          (total_resuspension_mL<span class="sc">/</span>volume_plated_ul) <span class="sc">*</span> <span class="dv">1000</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(organ, count_date, who_plated, who_counted, groups,  mouse, dilution,  </span>
<span id="cb20-9"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb20-9" aria-hidden="true" tabindex="-1"></a>         CFUs, CFUs_per_ml) <span class="sc">%&gt;%</span> </span>
<span id="cb20-10"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## Joining, by = &quot;organ&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tidy_cfu_meta_joined)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 9
##   organ count_date            who_plated who_counted groups mouse dilution  CFUs
##   &lt;chr&gt; &lt;chr&gt;                 &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
## 1 lung  &quot;\&quot;February 21 2022\… BK         BK          group… A            3    53
## 2 lung  &quot;\&quot;February 21 2022\… BK         BK          group… A            4     9
## 3 lung  &quot;\&quot;February 21 2022\… BK         BK          group… C            5     8
## 4 lung  &quot;\&quot;February 21 2022\… BK         BK          group… D            3    53
## 5 lung  &quot;\&quot;February 21 2022\… BK         BK          group… A            2    92
## 6 lung  &quot;\&quot;February 21 2022\… BK         BK          group… A            4     7
## # … with 1 more variable: CFUs_per_ml &lt;dbl&gt;</code></pre>
</div>
<div id="create-initial-report-information-for-these-data" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Create initial report information for these data<a href="colony-forming-units-to-determine-bacterial-counts.html#create-initial-report-information-for-these-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-1" aria-hidden="true" tabindex="-1"></a>tidy_lung_cfu_plot <span class="ot">&lt;-</span> tidy_cfu_meta_joined <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(organ <span class="sc">==</span> <span class="st">&quot;lung&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">fct_relevel</span>(groups, <span class="st">&quot;group_1&quot;</span>, <span class="st">&quot;group_2&quot;</span>, <span class="st">&quot;group_3&quot;</span>, <span class="st">&quot;group_4&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> groups, <span class="at">y =</span> <span class="fu">log10</span>(CFUs_per_ml), <span class="at">fill =</span> groups))<span class="sc">+</span></span>
<span id="cb24-5"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>( <span class="fu">aes</span>(<span class="at">x =</span> groups, <span class="at">y =</span> <span class="fu">log10</span>(CFUs_per_ml)), </span>
<span id="cb24-6"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom=</span><span class="st">&#39;errorbar&#39;</span>, <span class="at">linetype=</span><span class="dv">1</span>, <span class="at">width=</span><span class="fl">0.5</span>)<span class="sc">+</span> </span>
<span id="cb24-7"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group =</span> groups), <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;lightgrey&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-8"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb24-9"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;CFUs in early infected mouse lung&quot;</span>), <span class="at">x =</span> <span class="st">&quot;Group&quot;</span>, <span class="at">y =</span> <span class="st">&quot;log10(CFU/mL)&quot;</span>,</span>
<span id="cb24-10"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Group&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-11"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb24-12"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb24-13"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">label =</span> <span class="st">&quot;p.signif&quot;</span>, <span class="at">method =</span> <span class="st">&quot;t.test&quot;</span>, <span class="at">ref.group =</span> <span class="st">&quot;group_1&quot;</span>) <span class="sc">+</span> </span>
<span id="cb24-14"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>))</span>
<span id="cb24-15"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb24-16" aria-hidden="true" tabindex="-1"></a>tidy_lung_cfu_plot</span></code></pre></div>
<p><img src="csu-impactb_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="sample-anova" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Sample ANOVA<a href="colony-forming-units-to-determine-bacterial-counts.html#sample-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb25-1" aria-hidden="true" tabindex="-1"></a>cfu_stats <span class="ot">&lt;-</span> tidy_cfu_meta_joined <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(organ) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">aov_result =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">aov</span>(CFUs_per_ml <span class="sc">~</span> groups, <span class="at">data =</span> .x)),</span>
<span id="cb25-5"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb25-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">tukey_result =</span> <span class="fu">map</span>(aov_result, TukeyHSD),</span>
<span id="cb25-6"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb25-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidy_tukey =</span> <span class="fu">map</span>(tukey_result, broom<span class="sc">::</span>tidy)) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(tidy_tukey, <span class="at">.drop =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(contrast, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;contrast1&quot;</span>, <span class="st">&quot;contrast2&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-9"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>data, <span class="sc">-</span>aov_result, <span class="sc">-</span>tukey_result, <span class="sc">-</span>term, <span class="sc">-</span>null.value)<span class="co"># %&gt;%</span></span></code></pre></div>
<pre><code>## Warning: The `.drop` argument of `unnest()` is deprecated as of tidyr 1.0.0.
## All list-columns are now preserved.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb27-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(adj.p.value &lt;= 0.05)</span></span>
<span id="cb27-2"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="colony-forming-units-to-determine-bacterial-counts.html#cb27-3" aria-hidden="true" tabindex="-1"></a>cfu_stats</span></code></pre></div>
<pre><code>## # A tibble: 9 × 7
## # Groups:   organ [2]
##   organ  contrast1 contrast2 estimate conf.low conf.high adj.p.value
##   &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 lung   group_2   group_1    -60953. -138742.    16836.      0.171 
## 2 lung   group_3   group_1    -63903. -135699.     7893.      0.0963
## 3 lung   group_4   group_1    -26214. -102416.    49987.      0.793 
## 4 lung   group_3   group_2     -2950.  -69900.    64000.      0.999 
## 5 lung   group_4   group_2     34739.  -36915.   106393.      0.569 
## 6 lung   group_4   group_3     37689.  -27410.   102787.      0.417 
## 7 spleen group_2   group_1     -6565   -13529.      399.      0.0656
## 8 spleen group_3   group_1     -7310   -13341.    -1279.      0.0178
## 9 spleen group_3   group_2      -745.   -6776.     5286.      0.943</code></pre>
</div>
<div id="save-processed-data-to-database" class="section level2 hasAnchor" number="5.10">
<h2><span class="header-section-number">5.10</span> Save processed data to database<a href="colony-forming-units-to-determine-bacterial-counts.html#save-processed-data-to-database" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="example-two" class="section level2 hasAnchor" number="5.11">
<h2><span class="header-section-number">5.11</span> Example two<a href="colony-forming-units-to-determine-bacterial-counts.html#example-two" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mouse-weights.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="enzyme-linked-immunosorbest-assay-elisa.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["csu-impactb.pdf", "csu-impactb.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
