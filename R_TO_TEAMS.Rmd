---
title: "Connect R to Microsoft Teams"
author: "Taru Dutt"
date: "2022-10-19"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = FALSE)
```

## Download Microsoft365R package

```{r}
install.packages("Microsoft365R")
install.packages("AzureGraph")
install.packages("RODBC")
```

## Load the package

```{r}
library(Microsoft365R)
library(AzureGraph)
library(AzureAuth)

```

## Set up teams via R

```{r}
my_team <- get_team("CVMBS-MIP IMPAc-TB", app = "04b07795-8ddb-461a-bbee-02f9e1bf7b46")

# get the channel

channels <- my_team$get_channel()

# get the folder

folder <- channels$get_folder()

# list files
files <- folder$list_files()

# open weight file

body_weight <- folder$get_item("Mouse_labeling_and_weighing/Body Weights.xlsx")
body_weight$open()
body_weight$download(overwrite=TRUE)

```


